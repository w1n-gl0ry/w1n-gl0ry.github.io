<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>LYYL' Blog - 毋忧拂意，毋喜快心，毋恃久安，毋惮初难。</title>
  <meta name="keywords" content="LYYL, Blog, Pwn, pwn">
  <meta name="author" content="LYYL">
  <meta name="copyright" content="LYYL">
  <meta name="format-detection" content="telephone=no">
  <meta name="theme-color" content="#0d0d0d">
  <meta name="description" content="毋忧拂意，毋喜快心，毋恃久安，毋惮初难。">
  <meta property="og:type" content="website">
  <meta property="og:title" content="LYYL&#39; Blog">
  <meta property="og:url" content="https://www.lyyl.online/page/2/index.html">
  <meta property="og:site_name" content="LYYL&#39; Blog">
  <meta property="og:description" content="毋忧拂意，毋喜快心，毋恃久安，毋惮初难。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:image" content="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/favicon.png">
  <meta property="article:author" content="LYYL">
  <meta property="article:tag" content="LYYL, Blog, Pwn, pwn">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/favicon.png">
  <link rel="shortcut icon" href="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/favicon.png">
  <link rel="canonical" href="https://www.lyyl.online/page/2/">
  <link rel="preconnect" href="//cdn.jsdelivr.net" />
  <link rel="preconnect" href="//www.google-analytics.com" crossorigin="" />
  <link rel="preconnect" href="//busuanzi.ibruce.info" />
  <link rel="stylesheet" href="/css/index.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print"
    onload="this.media='all'">
  <script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>(adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: 'ca-pub-8740935439028405',
      enable_page_level_ads: 'true'
    });</script>
  <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MBZHBXMDJ2"></script>
  <script>window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-MBZHBXMDJ2');
  </script>
  <script>const GLOBAL_CONFIG = {
      root: '/',
      algolia: undefined,
      localSearch: undefined,
      translate: undefined,
      noticeOutdate: undefined,
      highlight: { "plugin": "highlighjs", "highlightCopy": true, "highlightLang": true, "highlightHeightLimit": 200 },
      copy: {
        success: '复制成功',
        error: '复制错误',
        noSupport: '浏览器不支持'
      },
      relativeDate: {
        homepage: false,
        post: false
      },
      runtime: '',
      date_suffix: {
        just: '刚刚',
        min: '分钟前',
        hour: '小时前',
        day: '天前',
        month: '个月前'
      },
      copyright: undefined,
      lightbox: 'fancybox',
      Snackbar: undefined,
      source: {
        jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
        justifiedGallery: {
          js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
          css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
        },
        fancybox: {
          js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
          css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
        }
      },
      isPhotoFigcaption: false,
      islazyload: false,
      isanchor: false
    }</script>
  <script id="config-diff">var GLOBAL_CONFIG_SITE = {
      title: 'LYYL\' Blog',
      isPost: false,
      isHome: true,
      isHighlightShrink: false,
      isToc: false,
      postUpdate: '2022-05-26 15:57:20'
    }</script><noscript>
    <style type="text/css">
      #nav {
        opacity: 1
      }

      .justified-gallery img {
        opacity: 1
      }

      #recent-posts time,
      #post-meta time {
        display: inline !important
      }
    </style>
  </noscript>
  <script>(win => {
                               win.saveToLocal = {
                                 set: function setWithExpiry(key, value, ttl) {
                                   if (ttl === 0) return
                                   const now = new Date()
                                   const expiryDay = ttl * 86400000
                                   const item = {
                                     value: value,
                                     expiry: now.getTime() + expiryDay,
                                   }
                                   localStorage.setItem(key, JSON.stringify(item))
                                 },

                                 get: function getWithExpiry(key) {
                                   const itemStr = localStorage.getItem(key)

                                   if (!itemStr) {
                                     return undefined
                                   }
                                   const item = JSON.parse(itemStr)
                                   const now = new Date()

                                   if (now.getTime() > item.expiry) {
                                     localStorage.removeItem(key)
                                     return undefined
                                   }
                                   return item.value
                                 }
                               }

                               win.getScript = url => new Promise((resolve, reject) => {
                                 const script = document.createElement('script')
                                 script.src = url
                                 script.async = true
                                 script.onerror = reject
                                 script.onload = script.onreadystatechange = function () {
                                   const loadState = this.readyState
                                   if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                                   script.onload = script.onreadystatechange = null
                                   resolve()
                                 }
                                 document.head.appendChild(script)
                               })

                               win.activateDarkMode = function () {
                                 document.documentElement.setAttribute('data-theme', 'dark')
                                 if (document.querySelector('meta[name="theme-color"]') !== null) {
                                   document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
                                 }
                               }
                               win.activateLightMode = function () {
                                 document.documentElement.setAttribute('data-theme', 'light')
                                 if (document.querySelector('meta[name="theme-color"]') !== null) {
                                   document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
                                 }
                               }
                               const t = saveToLocal.get('theme')

                               if (t === 'dark') activateDarkMode()
                               else if (t === 'light') activateLightMode()

                               const asideStatus = saveToLocal.get('aside-status')
                               if (asideStatus !== undefined) {
                                 if (asideStatus === 'hide') {
                                   document.documentElement.classList.add('hide-aside')
                                 } else {
                                   document.documentElement.classList.remove('hide-aside')
                                 }
                               }

                               const detectApple = () => {
                                 if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
                                   document.documentElement.classList.add('apple')
                                 }
                               }
                               detectApple()
                             })(window)</script>
  <meta name="generator" content="Hexo 6.2.0">
</head>

<body>
  <div id="sidebar">
    <div id="menu-mask"></div>
    <div id="sidebar-menus">
      <div class="avatar-img is-center"><img src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/favicon.png"
          onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar" /></div>
      <div class="site-data">
        <div class="data-item is-center">
          <div class="data-item-link"><a href="/archives/">
              <div class="headline">文章</div>
              <div class="length-num">27</div>
            </a></div>
        </div>
        <div class="data-item is-center">
          <div class="data-item-link"><a href="/categories/">
              <div class="headline">分类</div>
              <div class="length-num">5</div>
            </a></div>
        </div>
      </div>
      <hr />
      <div class="menus_items">
        <div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a>
        </div>
        <div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span>
              Archives</span></a></div>
        <div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span>
              Categories</span></a></div>
        <div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span>
              About</span></a></div>
      </div>
    </div>
  </div>
  <div class="page" id="body-wrap">
    <header class="full_page" id="page-header"
      style="background-image: url('https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/index_img.jpeg')">
      <nav id="nav"><span id="blog_name"><a id="site-name" href="/">LYYL' Blog</a></span>
        <div id="menus">
          <div class="menus_items">
            <div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span>
                  Home</span></a></div>
            <div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span>
                  Archives</span></a></div>
            <div class="menus_item"><a class="site-page" href="/categories/"><i
                  class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div>
            <div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span>
                  About</span></a></div>
          </div>
          <div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div>
        </div>
      </nav>
      <div id="site-info">
        <h1 id="site-title">LYYL' Blog</h1>
        <div id="site_social_icons"><a class="social-icon" href="https://github.com/liuzhongchina521"
            rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a
            class="social-icon" href="mailto:liuzhongchina521@gmail.com" rel="external nofollow noreferrer"
            target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div>
      </div>
      <div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div>
    </header>
    <main class="layout" id="content-inner">
      <div class="recent-posts" id="recent-posts">
        <div class="recent-post-item">
          <div class="post_cover left_radius"><a href="/posts/4199921919.html"
              title="CVE-2021-3156 sudo heap-based bufoverflow 复现&amp;分析"> <img class="post_bg"
                src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-24.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'"
                alt="CVE-2021-3156 sudo heap-based bufoverflow 复现&amp;分析"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/4199921919.html"
              title="CVE-2021-3156 sudo heap-based bufoverflow 复现&amp;分析">CVE-2021-3156 sudo heap-based bufoverflow
              复现&amp;分析</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2021-07-30T06:39:11.000Z"
                  title="发表于 2021-07-30 14:39:11">2021-07-30</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories"
                  href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a></span></div>
            <div class="content">文章首发于安全客
              CVE-2021-3156 sudo heap-based bufoverflow 复现&amp;分析
              CVE-2021-3156是sudo的一个堆溢出漏洞，可以用来进行本地提权。在类uninx中非root可以使用sudo来以root的权限执行操作。由于sudo错误的转义了\\导致了一个堆溢出漏洞。
              漏洞影响版本为1.8.2-1.8.31sp12, 1.9.0-1.9.5sp1，sudo &gt;=1.9.5sp2的版本则不受影响。
              感谢luc师傅带我飞。
              环境搭建这里我首先使用的是docker ubuntu 20.04，查看一下sudo版本，这里需要注意的是首先需要创建一个普通权限的用户
              123456normal@c957df720fc7:/root/pwn/漏洞/CVE-2021-3156/CVE-2021-3156_blasty$ sudo --versionSudo version
              1.8.31Sudoers policy plugin version 1.8.31Sudoers file grammar version 46Sudoers I/O plugi ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover right_radius"><a href="/posts/4269520279.html" title="2020 纵横杯线下 WP"> <img
                class="post_bg" src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-14.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020 纵横杯线下 WP"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/4269520279.html"
              title="2020 纵横杯线下 WP">2020 纵横杯线下 WP</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2021-03-31T11:27:52.000Z"
                  title="发表于 2021-03-31 19:27:52">2021-03-31</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories" href="/categories/CTF-WriteUp/">CTF WriteUp</a></span></div>
            <div class="content">异或不在星期天-pwn1推测应该是一个栈溢出。但是encode函数太大，无法反汇编，因此这里不知道该怎么利用。
              patch的话将return 0函数patch为exit。直接退出，要保存返回值一致的话还需要将rdi清空。
              Babyhttpd-pwn2首先用ida反编译看到这是一个pyinstaller打包的文件
              123456789101112.rodata:000000000000639D 0000000F C /proc/self/exe.rodata:00000000000063AC 00000019 C
              Py_DontWriteBytecodeFlag.rodata:00000000000063C5 0000001D C
              Py_FileSystemDefaultEncoding.rodata:00000000000063E2 0000000E C Py_FrozenFlag.rodata:00000000000063F0
              00000019 C Py_IgnoreEnvironmentFlag.rodata:0000000000006409 0000000E C Py_NoSite ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover left_radius"><a href="/posts/3469048985.html" title="2021 AntCTFxD3CTF PWN WriteUp">
              <img class="post_bg" src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-62.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 AntCTFxD3CTF PWN WriteUp"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/3469048985.html"
              title="2021 AntCTFxD3CTF PWN WriteUp">2021 AntCTFxD3CTF PWN WriteUp</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2021-03-07T12:06:17.000Z"
                  title="发表于 2021-03-07 20:06:17">2021-03-07</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories" href="/categories/CTF-WriteUp/">CTF WriteUp</a></span></div>
            <div class="content">d3dev这里没有加monitor=/dev/null，所以可以直接通过CRTL_ALT_2进入控制台。
              d3dev-revengeqemu逃逸
              分析首先看一下启动脚本
              123456789101112#!/bin/sh./qemu-system-x86_64 \-L pc-bios/ \-m 128M \-kernel vmlinuz \-initrd rootfs.img
              \-smp 1 \-append &quot;root=/dev/ram rw console=ttyS0 oops=panic panic=1 nokaslr quiet&quot; \-device
              d3dev \-netdev user,id=t0, -device e1000,netdev=t0,id=nic0 \-nographic \-monitor /dev/null

              我们看到这里的device的名称是d3dev，ida看一下相关的函数，发现存在mmio/pmio两种方式，分别分析一下，首先看一下pmio_read
              12345678910uint64_t __fastcall d3dev_pmio_ ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover right_radius"><a href="/posts/3399981355.html"
              title="CVE-2020-14364 QEMU 越界读写漏洞复现&amp;分析"> <img class="post_bg"
                src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-76.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2020-14364 QEMU 越界读写漏洞复现&amp;分析"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/3399981355.html"
              title="CVE-2020-14364 QEMU 越界读写漏洞复现&amp;分析">CVE-2020-14364 QEMU 越界读写漏洞复现&amp;分析</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2021-02-19T01:32:34.000Z"
                  title="发表于 2021-02-19 09:32:34">2021-02-19</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories"
                  href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a></span></div>
            <div class="content">环境搭建创建usb设备
              12qemu-img create -f raw usb.img 32Mmkfs.vfat usb.img

              编译qemu
              1234567git clone git://git.qemu-project.org/qemu.gitcd qemugit checkout tags/v4.2.1mkdir -p
              bin/debug/naivecd bin/debug/naive../../../configure --target-list=x86_64-softmmu --enable-debug
              --disable-werror --enable-spicemake

              编译完成的二进制文件位于bin/debug/naive/x86_64-softmmu/qemu-system-x86_64，启动脚本如下
              1234567891011qemu-system-x86_64 \ -m 1G -nographic \ -hda ./rootfs.img \ -kernel ./bzImage \ -append
              &quot;console=ttyS0 ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover left_radius"><a href="/posts/882088222.html" title="CVE-2019-6788-Qemu逃逸漏洞复现-分析"> <img
                class="post_bg" src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-31.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CVE-2019-6788-Qemu逃逸漏洞复现-分析"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/882088222.html"
              title="CVE-2019-6788-Qemu逃逸漏洞复现-分析">CVE-2019-6788-Qemu逃逸漏洞复现-分析</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2021-01-29T14:07:32.000Z"
                  title="发表于 2021-01-29 22:07:32">2021-01-29</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories"
                  href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a></span></div>
            <div class="content">CVE-2019-6788是一个qemu的逃逸漏洞，本文参考xmzyshypnc和raycp的文章
              环境搭建首先是创建qemu启动所用的文件系统，需要安装debootstrap，创建完成后的文件系统带有ssh，ssh/id_rsa为私钥。
              12345678910111213141516171819202122232425262728293031323334353637mkdir qemusudo debootstrap
              --include=openssh-server,curl,tar,gcc,\libc6-dev,time,strace,sudo,less,psmisc,\selinux-utils,policycoreutils,checkpolicy,selinux-policy-default
              \stretch qemuset -eux # Set some defaults and enable promtless ssh to the machine for root.sudo sed -i
              &#x27;/^root/ &#123; s/:x:/::/ &#125;&#x2 ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover right_radius"><a href="/posts/922614085.html" title="2020 starCTF 部分pwn WriteUp"> <img
                class="post_bg" src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-55.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020 starCTF 部分pwn WriteUp"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/922614085.html"
              title="2020 starCTF 部分pwn WriteUp">2020 starCTF 部分pwn WriteUp</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2021-01-18T04:07:10.000Z"
                  title="发表于 2021-01-18 12:07:10">2021-01-18</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories" href="/categories/CTF-WriteUp/">CTF WriteUp</a></span></div>
            <div class="content">感谢xmzyshypnc 师傅手把手教学。
              babyheap漏洞是一个UAF漏洞，程序实现了6个程序，add,delete,edit,show,leave_name,show_name，其中add函数限制了申请堆块的大小，delete函数中存在UAF漏洞，leave_name函数中申请了一个0x400大小的堆块。
              因此这里首先申请4个0x20,fastbin，接着leave_name函数申请一个较大的堆块，使得fastbin堆块合并成0x80大小的small
              bin，这样就能泄漏出libc基址，由于edit的起始位置是+8开始的，因此再次申请的堆块大小需要覆盖三个fastbin，因此申请一个0x60大小的堆块。这样就可以满足覆写fd指针为free_hook-8和/bin/sh字符串两个要求。
              12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879
              ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover left_radius"><a href="/posts/103439762.html" title="Adobe漏洞CVE-2018-4490分析"> <img
                class="post_bg" src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-69.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Adobe漏洞CVE-2018-4490分析"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/103439762.html"
              title="Adobe漏洞CVE-2018-4490分析">Adobe漏洞CVE-2018-4490分析</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2020-11-07T13:56:00.000Z"
                  title="发表于 2020-11-07 21:56:00">2020-11-07</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories"
                  href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a></span></div>
            <div class="content">漏洞描述CVE-2018-4490是Adobe在2018年5月修复的一个Adobe Reader DC的0 day漏洞（官方通告为Double
              Free漏洞，实际为任意地址释放），改漏洞配合Win32k提权漏洞CVE-2018-8120一起使用实现沙箱逃逸，实现任意代码执行。
              受影响版本：Adobe Acrobat and Reader versions 2018.011.20038 and earlier, 2017.011.30079 and earlier, and
              2015.006.30417 and earlier
              环境搭建样本：HASH：bd23ad33accef14684d42c32769092a
              Windows7 SP1 x86，Windbgx86
              Adobe Acrobat Reader Pro DC 2018.011.20035，JP2Klib.lib版本为1.2.2.39492
              这里在Windows7 SP1 X64，Windows10 2004中均可以进行调试，在Windows10中调试时需要注意内存地址0d0e0048可能被占用，需要在安全中心关闭 “验证堆完 ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover right_radius"><a href="/posts/1545760913.html" title="2020 ByteCTF 部分PWN WriteUp"> <img
                class="post_bg" src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-69.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020 ByteCTF 部分PWN WriteUp"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/1545760913.html"
              title="2020 ByteCTF 部分PWN WriteUp">2020 ByteCTF 部分PWN WriteUp</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2020-10-24T08:17:51.000Z"
                  title="发表于 2020-10-24 16:17:51">2020-10-24</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories" href="/categories/CTF-WriteUp/">CTF WriteUp</a></span></div>
            <div class="content">gunGLIBC 2.31
              程序实现了三个功能add,load,delete，其中add只能分配0x500一下的堆块，总共分配的堆块大小不超过0x1000，分配的基本单位是一个node，第一个值是buf，第二个值表示next_chunk，第三个值是flag。load是创建了一个全局的单项链表，通过node-&gt;next_chunk也就是+0x10的位置进行串联。在delete的时候未清空next_chunk的指针。通过delete,load,delete可以制造double
              free漏洞，并且在第二次delete的时候会泄露出地址。
              但是由于2.31对tcache double free进行了检查，这个题目没有办法进行修改其keys，因此采用fastbin attack的方法来做。覆写__free_hook为magic
              gadget的值，该gadget的作用是将rdi转移到rdx中，并调用setcontext，我们找到下面的gadget
              123mov rdx, qword ptr [rdi + 8]; mov qword ptr [rsp], rax; call qword ptr ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover left_radius"><a href="/posts/3129759790.html" title="逃逸初探"> <img class="post_bg"
                src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-25.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="逃逸初探"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/3129759790.html" title="逃逸初探">逃逸初探</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2020-10-19T02:40:45.000Z"
                  title="发表于 2020-10-19 10:40:45">2020-10-19</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories" href="/categories/CTF-WriteUp/">CTF WriteUp</a></span></div>
            <div class="content">2020 TSCTF hellovirtual是一个虚拟化的题目，在2018 hitcon
              abyss改编的题目。这里给出了三个文件hellovirtual,hellokernel,hellousr，还给出了ld.so.2,libc.so.6。
              hellovirtual是一个利用KVM
              api来做虚拟化的程序，它会加载一个小型的内核hellokernel，这个内核仅仅实现了内存管理和程序中断的功能，提供了loader启动和libc加载的一些syscall。然后解析ELF启动一个用户态的程序，这里直接使用的是ld.so.2来加载hellousr。hellousr是一个用户态的程序可以直接在主机上运行。执行流程就是用户态程序hellousr发生系统调用时，hellokernel对系统调用进行一些检查，将一些与IO相关的比如read,write通过I/O
              Prot(CPU in/out指令)交给hellovirtual处理。
              分析virtual先来看virtual也就是kvm。先放出几个常用的结构体，和操作的十六进制值。
              12345678910111213141516171819202122 ...</div>
          </div>
        </div>
        <div class="recent-post-item">
          <div class="post_cover right_radius"><a href="/posts/2046383052.html" title="2020 zer0pts CTF 部分PWN WriteUp">
              <img class="post_bg" src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-4.jpeg"
                onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020 zer0pts CTF 部分PWN WriteUp"></a></div>
          <div class="recent-post-info"><a class="article-title" href="/posts/2046383052.html"
              title="2020 zer0pts CTF 部分PWN WriteUp">2020 zer0pts CTF 部分PWN WriteUp</a>
            <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span
                  class="article-meta-label">发表于</span><time datetime="2020-09-28T06:52:58.000Z"
                  title="发表于 2020-09-28 14:52:58">2020-09-28</time></span><span class="article-meta"><span
                  class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a
                  class="article-meta__categories" href="/categories/CTF-WriteUp/">CTF WriteUp</a></span></div>
            <div class="content">
              babyof分析很容易发现程序中存在的漏洞，栈溢出，但是程序调用的外部函数仅有read,setbuf,exit这三个函数。此时如果想要泄露libc基址的话就需要覆写stdout结构体中的IO_write_ptr指针的低位为\x00即可，但是当我们更改指针低字节之后还是没有办法输出，因为函数没有任何的输出函数，因此就不会刷新stdout。
              这里我们就需要强制缓冲区刷新，即调用_IO_OVERFLOW，这里存在一个exit函数，因此我们可以直接exit，函数会调用_IO_cleanup_all，刷新每一个文件结构体，这是我们就可以泄露出libc的基址，但是泄露地址之后程序就退出了，因此我们还需要修改vtable表中的__overflow指针为main函数地址，以继续执行程序，再次利用溢出修改返回地址getshell。
              但是如果我们修改的是stdout的vtable的__overflow指针的话，我们的libc就无法泄露，注意到_IO_list_all的连接顺序为stderr,stdout_stdin，因此我们可以修改stderr的_IO_write_ptr的低字节和stdout的vtabl
              ...</div>
          </div>
        </div>
        <nav id="pagination">
          <div class="pagination"><a class="extend prev" rel="prev" href="/"><i
                class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span
              class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><a
              class="extend next" rel="next" href="/page/3/#content-inner"><i
                class="fas fa-chevron-right fa-fw"></i></a></div>
        </nav>
      </div>
      <div class="aside-content" id="aside-content">
        <div class="card-widget card-info">
          <div class="is-center">
            <div class="avatar-img"><img src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/favicon.png"
                onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar" /></div>
            <div class="author-info__name">LYYL</div>
            <div class="author-info__description">毋忧拂意，毋喜快心，毋恃久安，毋惮初难。</div>
          </div>
          <div class="card-info-data">
            <div class="card-info-data-item is-center"><a href="/archives/">
                <div class="headline">文章</div>
                <div class="length-num">27</div>
              </a></div>
            <div class="card-info-data-item is-center"><a href="/categories/">
                <div class="headline">分类</div>
                <div class="length-num">5</div>
              </a></div>
          </div><a class="button--animated" id="card-info-btn" target="_blank"
            rel="noopener external nofollow noreferrer" href="https://github.com/liuzhongchina521"><i
              class="fab fa-github"></i><span>Follow Me</span></a>
          <div class="card-info-social-icons is-center"><a class="social-icon"
              href="https://github.com/liuzhongchina521" rel="external nofollow noreferrer" target="_blank"
              title="Github"><i class="fab fa-github"></i></a><a class="social-icon"
              href="mailto:liuzhongchina521@gmail.com" rel="external nofollow noreferrer" target="_blank"
              title="Email"><i class="fas fa-envelope"></i></a></div>
        </div>
        <div class="card-widget card-announcement">
          <div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div>
          <div class="announcement_content">博客内容为Notion导出markdown，如有错误敬请谅解。</div>
        </div>
        <div class="sticky_layout">
          <div class="card-widget card-recent-post">
            <div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div>
            <div class="aside-list">
              <div class="aside-list-item"><a class="thumbnail" href="/posts/95726211.html" title="AFL源码及流程分析"><img
                    src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-3.jpeg"
                    onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AFL源码及流程分析" /></a>
                <div class="content"><a class="title" href="/posts/95726211.html" title="AFL源码及流程分析">AFL源码及流程分析</a><time
                    datetime="2022-05-26T07:20:45.000Z" title="发表于 2022-05-26 15:20:45">2022-05-26</time></div>
              </div>
              <div class="aside-list-item"><a class="thumbnail" href="/posts/1029211104.html"
                  title="V8 重新入门-2019 starCTF oob 题解"><img
                    src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-37.jpeg"
                    onerror="this.onerror=null;this.src='/img/404.jpg'" alt="V8 重新入门-2019 starCTF oob 题解" /></a>
                <div class="content"><a class="title" href="/posts/1029211104.html"
                    title="V8 重新入门-2019 starCTF oob 题解">V8 重新入门-2019 starCTF oob 题解</a><time
                    datetime="2021-11-05T14:20:21.000Z" title="发表于 2021-11-05 22:20:21">2021-11-05</time></div>
              </div>
              <div class="aside-list-item"><a class="thumbnail" href="/posts/1864456601.html"
                  title="2021 0CTF/TCTF Final Naive Heap"><img
                    src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-57.jpeg"
                    onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 0CTF/TCTF Final Naive Heap" /></a>
                <div class="content"><a class="title" href="/posts/1864456601.html"
                    title="2021 0CTF/TCTF Final Naive Heap">2021 0CTF/TCTF Final Naive Heap</a><time
                    datetime="2021-09-29T02:18:50.000Z" title="发表于 2021-09-29 10:18:50">2021-09-29</time></div>
              </div>
              <div class="aside-list-item"><a class="thumbnail" href="/posts/2427305175.html"
                  title="虚拟机逃逸&amp;漏洞复现"><img src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-17.jpeg"
                    onerror="this.onerror=null;this.src='/img/404.jpg'" alt="虚拟机逃逸&amp;漏洞复现" /></a>
                <div class="content"><a class="title" href="/posts/2427305175.html"
                    title="虚拟机逃逸&amp;漏洞复现">虚拟机逃逸&amp;漏洞复现</a><time datetime="2021-08-18T05:34:33.000Z"
                    title="发表于 2021-08-18 13:34:33">2021-08-18</time></div>
              </div>
              <div class="aside-list-item"><a class="thumbnail" href="/posts/3705072996.html"
                  title="2021 XCTF Final 线下WP"><img
                    src="https://lyyl-1254465038.cos.ap-beijing.myqcloud.com/bg/bg-32.jpeg"
                    onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 XCTF Final 线下WP" /></a>
                <div class="content"><a class="title" href="/posts/3705072996.html" title="2021 XCTF Final 线下WP">2021
                    XCTF Final 线下WP</a><time datetime="2021-07-30T07:26:18.000Z"
                    title="发表于 2021-07-30 15:26:18">2021-07-30</time></div>
              </div>
            </div>
          </div>
          <div class="card-widget card-categories">
            <div class="item-headline">
              <i class="fas fa-folder-open"></i>
              <span>分类</span>

            </div>
            <ul class="card-category-list" id="aside-cat-list">
              <li class="card-category-list-item "><a class="card-category-list-link"
                  href="/categories/CTF-WriteUp/"><span class="card-category-list-name">CTF WriteUp</span><span
                    class="card-category-list-count">13</span></a></li>
              <li class="card-category-list-item "><a class="card-category-list-link"
                  href="/categories/PWN%E6%80%BB%E7%BB%93/"><span class="card-category-list-name">PWN总结</span><span
                    class="card-category-list-count">4</span></a></li>
              <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/V8/"><span
                    class="card-category-list-name">V8</span><span class="card-category-list-count">1</span></a></li>
              <li class="card-category-list-item "><a class="card-category-list-link"
                  href="/categories/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"><span
                    class="card-category-list-name">源码分析</span><span class="card-category-list-count">1</span></a></li>
              <li class="card-category-list-item "><a class="card-category-list-link"
                  href="/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><span
                    class="card-category-list-name">漏洞复现</span><span class="card-category-list-count">5</span></a></li>
            </ul>
          </div>
          <div class="card-widget card-archives">
            <div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn"
                href="/archives/" title="查看更多">
                <i class="fas fa-angle-right"></i></a></div>
            <ul class="card-archive-list">
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span
                    class="card-archive-list-date">五月 2022</span><span class="card-archive-list-count">1</span></a></li>
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span
                    class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">1</span></a>
              </li>
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span
                    class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">1</span></a></li>
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span
                    class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">1</span></a></li>
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span
                    class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">7</span></a></li>
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span
                    class="card-archive-list-date">三月 2021</span><span class="card-archive-list-count">2</span></a></li>
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/02/"><span
                    class="card-archive-list-date">二月 2021</span><span class="card-archive-list-count">1</span></a></li>
              <li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span
                    class="card-archive-list-date">一月 2021</span><span class="card-archive-list-count">2</span></a></li>
            </ul>
          </div>
          <div class="card-widget card-webinfo">
            <div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div>
            <div class="webinfo">
              <div class="webinfo-item">
                <div class="item-name">文章数目 :</div>
                <div class="item-count">27</div>
              </div>
              <div class="webinfo-item">
                <div class="item-name">本站总字数 :</div>
                <div class="item-count">165k</div>
              </div>
              <div class="webinfo-item">
                <div class="item-name">本站访客数 :</div>
                <div class="item-count" id="busuanzi_value_site_uv"></div>
              </div>
              <div class="webinfo-item">
                <div class="item-name">本站总访问量 :</div>
                <div class="item-count" id="busuanzi_value_site_pv"></div>
              </div>
              <div class="webinfo-item">
                <div class="item-name">最后更新时间 :</div>
                <div class="item-count" id="last-push-date" data-lastPushDate="2022-05-26T07:57:19.281Z"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer id="footer">
      <div id="footer-wrap">
        <div class="copyright">&copy;2020 - 2022 By LYYL</div>
        <div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer"
            href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank"
            rel="noopener external nofollow noreferrer"
            href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div>
      </div>
    </footer>
  </div>
  <div id="rightside">
    <div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i
          class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i
          class="fas fa-arrows-alt-h"></i></button></div>
    <div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i
          class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i
          class="fas fa-arrow-up"></i></button></div>
  </div>
  <div>
    <script src="/js/utils.js"></script>
    <script src="/js/main.js"></script>
    <div class="js-pjax"></div>
    <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  </div>
</body>

</html>